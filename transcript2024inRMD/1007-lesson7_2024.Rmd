---
output:
  pdf_document: default
  html_document: default
---

editor_options: 
  markdown: 
    wrap: 72

# 以下是课堂语音转文字

各位同学晚上好
我们开始了
我们这一节课的话
就是在我们上节课的基础之上啊
学一个新的知识点
就是如何在r里面进行这个
去了解我们的数据
对吧通过这个描述性的统计
另外一个的话呢
就是如何通过可视化的方式
呃来对我们的数据进行描述
那么这就必然要求我们能够通过ie点
进行一些基本的数据的可视化
但如果还记得大纲的话
我们关于数据可视化有两课
今天这一课呢
是基本开始了解啊
用r做这个可视化
后面还有一节课呢
我们专门教大家
进一步的
对这个r怎么进行精细的调整
达到这种可以出版的这种
呃图片的这个形式
呃这个是我们上课之前
大家如果在我们这个Armada里面的话
这次呢我们有一些新增加的包
呃
大家第一次在自己本地运营的时候
可能需要跑一下这个`pacman::p_load()`
它会安装这些相应的工具包
那么他应该没有太额外的要求啊
至少在windows机器上安装顺利。

简单的回复一下上节课的内容
上节课的话
其实我们呃介绍了数据的预处理
对吧那么在介绍数据预处理的时候
我们其实也新增了一些
新增加了一些内容
就包括如何进行批量的这个数据读
取对吧所以呢
我们介绍了这个
使用这个Mr FILES
来去获得一个文件夹里面
所有某一个特定类型的文件
的这个名字
然后呢我们也呃定义了一个函数
进行这个数据类型的转换
确保读取进来之后
每一列的这个数据
是我们想要的这种数据类型
然后呢我们就通过一个复循环对吧
去介绍如何批量的读取数据
那么在这个过程中呢
我们也顺便介绍了复循环
大家如果后面呃
经常用r处理数据的话
就会发现
复循环以及e
等于就是一个非常好用的这个工具
那么这里面我们是演示了一下这个呃
用Fore循环读取这个数据
并且直接对它进行合并
然后保存数据
保存数据的话
我们上节课介绍的是save CSV对吧
但是在Blues r里面它也有这个
它除了一个import以外
也有一个对应的export
这个功能
就能够将我们的这个数据
保存为一个CSV
呃这样的话
呃
就能够把我们前面通过这个复循环
读取的这个数据
保存下来
不用每次都重新的进行这个呃
批量的读取对吧
可能也比较浪费时间
那么最后呢
我们在课在下课的时候
我们提到了一个新的功能对吧
就我们没有介绍
没有太介绍
为什么我们没有太介绍
因为我们的数据都是比较干净的
比较整洁的
但
那大家自己在这个预处理数据的时候
可能会碰到一些这些列的名字对吧
跟我们想要的这个变量名
它不是一个
所以我们可以通过Relay这种方式
来进行这个呃列的名字的一个修改
那么还有一些呃一些函数对吧
它可以批量的对一些呃列的名字
或对字符进行处理
比方说我们这里有个to no no对吧
就将这个字符的大写的字母
全部变成小写
那这大家可以根据自己的需求
进行这个选择
然后另外我们上节课呢也介绍
开始介绍这个使用pipeline对吧
就是在Tideworks这个这个这个系统下面
我们写这种管道的操作
那么写管道操作的时候呢
我们上节课主要是告诉大家哎
我们怎么去写对吧
那么写代码写多了之后
我们就就会有一种
就会需要这个代码更具有结构化
看起来更清晰对吧
比方说
大家觉得这个代码看起来怎么样
我们做了一些操作对吧
group by分组
然后求summarize对吧
求分组求这个me呃
然后ungroup
然后呢
再把它通过这个get的方式对吧
把它进行一些呃形式的转换
然后最后呢
以某一个值进行排序对吧
这个看起来就不是非常清晰
因为我们就感觉
很多步骤都整合到一起了
对吧
然后我们也看不出来他做了多少步
所以呢在这个Titleworth
这个呃这一套的风格之下呢
有一些网站会专门推荐大家
采用什么样的
一个规范的形式去写代码
这样的话
让你的代码看起来呃干净和整洁
那比方一个比较推荐的方式呃
而且是我们最常用的
比方说我
们管道处理的话
最常用的就是我们会有多个
这个多个步骤
对吧多个预处理的步骤
然后每一个步骤我们最好让它占一行
然后这个管道符后面进行换行
这样的话
看起来它的整个风格就是比较一致
对吧然后每一步做了什么
我们看起来比较清楚
比方说group by summarize
然后随后就进行ungroove对吧
这基本上是
我们使用Tidy verse处理的时候
一个呃就是一个组合了
然后最后进行arrange
那么这里有一个参考链接
大家如果下载了这个呃
我们这个Notebook的话
应该能够获直接获取到这个链接
当然
我们这里只是说简单的提示了一下
如何应该整洁规范的写代码
那么大家可能在后续的过程中
可能还会有其他的一些更多的就发现
有一些更多的风格
可能会帮助你更好的去记忆写代码
以及帮助你整理这个数据分析的思路
大家可以参考这个链接啊
然后呢呃还有一个就是说呃在Armadan
呃这应该是a studio里面
其实它会自动的
有时有时候会帮你自动的呃
去整理这个代码
比方说我们这里写成这样对吧
你可以采用这个
a studio里面的一个自动的Reformat
就是自动的帮你把它这个格式性调整
呃然后呢
你会看到一个比较规整的方式
当我自己试了一下
我发现这个快捷键
可能在一部分电脑上面是适用的
在另一部分电脑上
可能你有其他的快捷键
也是这个组合
那么相互这就冲突了
但级别冲突的话
我们可以看一下效果啊
这是我们第七章的这个整个Armach down
对吧我们直接跳到刚才这个地方
大家可以看到这里
我们跟这里展示是一样的对吧
就是我们之前说的那个不太规则
不太规范的一个代码的书写的方式
那么当然如果快捷键没有冲突呢
你就可以直接按control加shift
加a就可以了
呃我因为电脑上面有这个冲突啊
所以我们还是可以点一下这个code
r studio的上面code
然后你可以找到
下面有一个叫做Reformate code
这个时候大家可以看到
他就自动的把这个改了对吧
然后他改的这个代码就非常的整齐
然后基本上是以逗号做分隔对吧
每一个逗号后面就给你分隔成一行
然后前面的这个
我们说的这个缩镜也是完全对齐的
那么你就可以看到这个
这一行代码是从什么时候开始
什么时候结束对吧
然后有做了几个事情
或者叫输入了几个参数
这样的话就比较清晰
他比之前的话
我们可以回过头来比之前的话
他就相对来说
就是显得更加的整洁一点啊
这些这些小的技巧
但是你在写代码的这些小的
小的这种技巧
会有的时候会提高你的效率
或者帮助你更好的理清这个思路
那么这里是一个小小的总结
就是我们在上节课呃提到的
在数据清洗
使用Tidy verse进行数据清洗的时候
碰到的一些常见的一些代码
包括像mutate对吧
然后select
还有这个filter
slice filter我没有怎么讲
这个应该呃
大家可以找一下
我们更常用的是filter
然后各种合并对吧
然后长短宽
还有这个分组计算的
还有制服串的操作
那么制服串的操作的话
这里呃我没有细致展开
但是大家会发现
如果你真的要进行数制服的处理的话
他是一个呃比较
就是说不需要记
但是有很多小细节需要注意的
我们之前提到过
大家可以去用的时候会呃
需要注意一点
然后最后的话就是函数是变成这个
跟apply这种类似的就批量处理了
我们也没有展开讲
因为这些都是比较复杂的功能
呃这些功能
大家在随着自己使用的
这个就相当经验增加的时候呢
再去探索他们的功能
会让你的效率提高
那么我们今天呢
就是主要是在先讲
就是类似于我们在数据分析当中
我们读取的数据对吧
批量读取的数据
然后呢
我们也知道对数据进行怎么操作了
假定我们就是能够按照
我们上节课学到的
这个数据清理的方式
对数据进行一些处理
处理完了之后呢
我们可能这个时候想知道
我们这个数据到底是不是我们想要的
对吧是不是跟我们预期的是一样的
以及这个数据中有什么样的规律
那就是我们数据清理之后
想要做的内容对吧
就是查看数据内容
然后进行后续的一系列的分析
那么我们可以看
假如说我们呃用一些r
里面生成的一些代码
就是帮我们快速的预览整个数据的
概括这些代码的话
比方说我们有之前看到过这个head
对吧
就是把一个数据的前面的几行打出来
让我们看到它是什么
然后我们这里用了一个呃
一个有趣的数据啊
大家可以看到
打印出来
你看到好像没有什么太大的问题对吧
呃有一有三列
然后x y然后它有一个呃
前面第一列是一个一个一个字符
然后你对他用这个string对吧
str去看他这里面的一个情况对吧
这个带呃
这个data from里面的情况
你可以看到它这个第一个是一个字符
对吧后面两个x y都是numerical
都是字符
然后它是这种data free
没什么问题
看起来都非常好对吧
然后你看summary
就你看它这个数据的整体的概况对吧
好像也没有任何的问题
包括XY都有它自己的这个均值有
呃最大值最小值
看起来很正常一个数据对吧
那么但是假如我们对它进行可视化呢
大家可以看到
在这在这个动图当中对吧
呃不同的
这个数据集在变对不对
这个数据集在变
然后呢
我们如果说直接看它的统计量对吧
比方说x和YG的关系
就是它的这个斜线对吧
这个斜率它基本上都是没有变的
对不对
但是这个数据的模式却千变万化
是不是
有的是这种
就是几列
有的是几行对吧
还有这种非常分散的
还有这种圆圈状的
还包括最后
这个恐龙的这个数据
那么这个实际上
这个数据
告诉我们一个非常重要的问题
这这是大家以后在数据分析中
都要去记住的
一个非常重要的点
就是什么呢
你在分析数据的时候
绝对不能只看我们前面的这些统计量
或者我们就直接看他的p值
替值或者是相关系数
这这这一类的统计值
我们一定要去看
这个原始数据长什么样子
这就是我们这节课要强调的
就是
我们一定要去了解原始数据的特点
这样的话
你做到你知道这个数据原始的数据
它一个一个长什么样子对吧
是不是在一个合理的范围之内
那么我们通过这种看summary day的
就是看这种描述数据也好
或者通过做图的方式
去对这个数据进行一个基本的可视化
让我们去了解这个数据最原始的状态
也好
它都属于一个更广泛的一个概念
叫做探索性的数据分析
那么呃
在data science现在这个数据科学非常呃
就是因为数据越来越多对吧
数据科学也越来越复杂的这个
现在这个时代
这个EDA就是探索性的数据分析呢
也越来越被很多数据分析的这个呃
专家所推荐
因为通过这种探索的话
有可能你就能够发现
以前你只看统计量
或者说你这个这个只看这个统计分析
统计检验你没办法看到的一些模式
那么所以在这个探索性的分析
就是
我们通常就是通过这种总结数据
这么一些主要的特征
对吧然
后呢通过尤其通过可视化的方式
去寻找这个数据里面的一些特点
然后呢这样帮助我们理清
你下一步要做什么分析
那大家可以看到
我们前面讲说这个探索性的数据分析
主要是为了什么呀
对数据的主要特征进行一个描述对吧
那么这个时候的话
很自然而然
你每你不管你通过什么样的方式
去对这个数据进行描述
或进行可视化
都意味着你在去他
你要去让这些可视化的这个东西
辅助你去更好地了解
这个数据的某一方面特点
也就是说
帮助你去回答某一些特定的问题
那么这个时候的话
其实我们在探索性的过程中
其实看起来是漫无目的的
但实际上你是通过可视化
不断的让你去回答一些问题
对吧那么也就是说
我们在做探索性数据分析的时候
实际上你要做一些基本的判断
那么每一次探索
都要回答一些特定的问题
一般来说
我们会从一些最基本的问题开始对吧
比方说你这个数据有哪些变量
然后每一个变量它类型是什么
它呈现一个什么样的分布
它们之间的关系是什么
对吧
那么这意味着我们先要去了解这些
呃就是快速的
然后了解大量的信息
呃这里我们采用了两个数据啊
就是我们之在之前的课上面
我们都已经用到过的数据
一个是那个payment data对吧
就是蜗牛的数据
另外一个就是我们反应时间的数据
上节课通过代码进行的这个读取
那么我们前面
其实已经讲到了一类代码对吧
迅速的帮助我们去了解
这个数据框的概况
一个是这个head
就是读取打印出这个数据框的呃
前面的几行或者几列对吧
那么我们在这个代码里面
我们可以看到
为了适合在网页中输出的话
我们其实是有一些额外的代码
嗯
我们可以这里直接快速跳过
然后把这里是把这个数据读取出来
然后呢
我们可以这里看这个head对吧
这就在r里面
在r studio里面
我们可以直接这么去查看这个数据的
这个head它的前面的角
相信r studio它是比较方便它可以
改变这是其实RSG的
一个比较方便的一个点
如果说有更多的话
它可以其实往后面去翻页
这个我们前面可能引用
另外一个呢
就是这个str对吧
str也是一个非常常见的
去了解这个数据结构的一个形式
那么当我们的呃
表现列不是特别多的时候对吧
没有成百上千行
也是当我们使用这个str打出来的
这个列的数量
还是能够在
我们能够快速处理的范围之内
的时候我们其实就可以用它
来去查看这个数据类型
对吧比方说我们在读取数据的时候
其实我们专门做了一个
写了一个函数
对每一列进行转换对吧
那么转换完了之后
你把它核定完了之后
其实还是得检查一下
是不是真的就是按照你预期的那样
那么我们就可以通过STR来去看
比方说这
个首先它是第一行
就是它整个数据的一个特点对吧
它有16个变量
也就十16个列
然后有多少个
这个Offspace有多少行对吧
然后每一列它分别是什么样的一个呃
数据类型对吧
呃然后它这里面有什么样的
这个前面的几个值是什么
他都会给列出来
这样的话就给我们一个快速的预览
这个数据长什么样
然后除了这两个以外呢
还有一些其他的一些常见的函数
比方说summary
我们前面刚刚用到的对吧
呃但是呢还有一个更加常用的
就是这叫做scheme r的一个函一个包
那么这个包呢
其实它就是大家可以理解为
它就是这个summary的一个升级版
就相当于说我们呃
需要更加快速的去预览整个数据框
的时候
那么有人就专门开发了这一个包
去帮助我们做这个事情
那么它的这个主要的函数就是scheme
scheme本来就是快速的去预览的意思
对吧那么我们对这个MT
就是对这个matching的这个数据
我们比方说
用这个scheme码做一个预览之后
我们它的它凹凸的比较长啊
所以我们分了三页来进行展示
大家可以看到这这就是它预染的结果
那么它的一个比较呃好的一个特点
因为它会根据你这个
每一列的一个数据类型
去进行预染
第二个呢
它在最后一列的时候它会对称
就是叫做Lyrical制服型的
它会给你一个它的一个分布的特点
所以大家可以看到这里
我们就能够迅速
的去预览一些数值性
它的大概一个分布
那么我们可以看到
它是不是符合我们的呃
一些特点对吧
比方说我们可以看到这个呃6对吧
ACC当中间的有点多啊
那么ACC它对应的一个分布是这样的
那么这个对我们来说就是正常的对吧
因为大家如果还记得的话
这个ACC表示是什么
accuracy对吧
在没有清理的时候
它是有四个取值的
就是零1-1和2对吧
那么它这看起来就是比较合理的
然后还有RT
看起来就是比较正态分布的对吧
当然它这里是一个非常浓缩的一个有
有非常浓缩的一个状态
要要准确的查看的话
我们一会会通过画图的方式来看
那么这种方式的话
就是我们还没有自己去画图对吧
他就已经跟我们把这个概念给出来了
所以这是一个比较呃
大家比较推荐的包
然后呢还有一个包就是布鲁萨
我们多次推荐过布鲁萨对吧
呃这个包它它有一个函数叫做describe
就是描述对吧
但这个这个包括这个函数
它更加适合一种情况
就是
我们已经知道自己要对哪一些数据
进行描述性的统计了
这个时候呢
这个行就会给我们迅速的输出
比方说我们想要知道RT和呃
或者是某一个条件下的RT
它的一个比方说它有多少数据点
它的均值是多少对吧
以及它的密点
中位数最小值最大值等等等等
那么这个时候呃
呃这个这个DISCORD就非常的适合我们
但有的时候的话
当我们还不清楚
我们要对哪些数据
进行描述性的统计的话
这个时候DISCORD就不太适合我们
然后另外呢
就是DISCORD
它是比较适合你
要输出心理学所认的这种三线表
这个时候是最好用的
那我们把刚才说的这些
在r里面操作一下
大家可以看到r studio里面
它跑出来是什么样子
嗯这个summary大家可能
已经
看一下啊
这个好像是在rend的时
就是这个是在我们用
应该是在Armadam把它编成网页的时候
他可能才会用到这个
如果我们只看他的话
也就是说
我们自己在阿马克旦里面
想要运行它的话
可以就忽略它
只运行前面这个
这就是这个summary
给我们看到的一个结果
然后我们刚刚讲的这个scheme r对吧
可能我前面没有装载这个包啊
所以我们可能刚开始的时候
还是把第第一行这个package
这个得运行一下
要不然的话后面会容易出出错啊
数据我们都有了
这个是scheme他给的结果
大家可以看到他这里是有多个屏啊
基本上跟我们刚才说的
是展示的是一样的
因为我们展示就是对他进行一个截图
那有的时候像这种数据和呃
这个呃叫什么
就是制服的一起
这放一个数据框的时候
有的时候这个scheme就没有给出来
我们的结果就不是特别好
对吧
Bose r也是
在我们刚刚显示过它的结果
就是它的一个好处
就是三线
表特别的漂亮
然后呢你也可以直接把它
保存为word的这个文档
OK这就是我们常常见的一些呃
r里面的一些秘密啊
就是用来快速的
去对我们的这个数据进行预览
但是我们刚才说了对吧
那么仅仅是看这种数值的结果
其实是远远不够的
我们还得去通过画图的方式对吧
那么所以呢
我们要进行一个可视化
那么可视化现在基本上是说呃
很多人就推荐你
在数据分析之前必须做可视化
对吧
那么我们刚才的一个那个动图呢
也其实非常好的展示了这么一点
那么可视化呢
它是一个就是非常有效
快速有效的方式来看一下我们的数据
是不是我们叫make sense对吧
就是不是真的是一个
是一个符合我们直觉的
比方说我们举个例啊
你你看到RT
如果说你是用比方说用秒来计时的话
你看到几百上千对吧
那么这样的数据肯定就是不太对劲的
或者是ACC对吧
你ACC如果你算出来之后
应该你作为正确率对吧
你最后一算出来
它应该是一个代表正确率的一个值
那么它超过一的话肯定就不太正常
那么如果你用可视化呢
很快就能够看到这一点
然后另外的话
它也是一个非常叫做honest对吧
就是非常诚实的方式
来来呈现我们的数据
所以呢这个是非常推荐的一个做法
那么我们刚才呈现的这个
就大家希望大家以后都能够在在做
不管是在做相关
分析还是用某一个test之前
你要记住这个
这个这个恐龙的这个图像
对吧
就是你到底有没有查看你的原始数据
是不是在查看原始数据之后
你再做后面的分析
然后我们要做这个
然后画这么一个一个一个恐龙对吧
我们自己要画这个恐龙
我们怎么画
在r里面
其实我们之前说过
r其实是一个非常强大的一个生态
对吧它有很多工具可以选择
那么画图而言的话
它也有非常多的这个呃功能
比方说有r的这个最基础的包率对吧
它叫base Graphics
它其实本来就有很强大的
一个画图功能
另外的话还有protein这种画动图的
那么我们一般来说
对于心理学或者是社会科学的
做研究的角度来讲的话
我们一般会选择机器Pro two呃
叫做叫做呃
Grammar of Graphics
这是两个记的一个呃缩写
就是叫做画图的语法
你可以这么理解
那么为什么我们要用它呢
因为它可以说
有几个非常好的一个特点
尤其是适合我们呃
就不管你是新手也好
还是非常熟练的老手也好
都非常适合
首先对于我们新手来说的话
其实有的时候你不知道
就是某一个图应该画什么
对吧应该采用就是
如果你有很多这个选项的话
作为新手
可能你不知道选什么是最好的
那么在gitbox里面
他会有大量的这个默认值
如果大家还记得
我们前面讲函数的时候
我们说调一个函数
如果这个函数有默认值的话
我们就不用再去给他输入这个参数了
对吧
那么在我们画图的这个基数到处里面
他就有大量的这个默认值
所以我们可以只有写很小的代码
很小的代码我们就能够画出出来
能够让我们迅速的去看到这个效果
第二个的话
我们是说他化繁为简对吧
但另一方面的话
他也能够非常精准的去定制
也就是说
当你了解了这个他的一些语法之后
你想输出一个
就是对这个图片的
图片的每一个元素进行精准的控制
这么一个图片
那基因Pro也完全能够做到
这就是我们的后面在讲这个
如何输出这种可发表的
这种图像的时候
我们就会对它进行精确的一个定制
然后第三个呢
就是说我们几乎他整个语法
就像那种PS一样的
就是一个图层加一个图层
但现在我们我不知道
现在大家还用Photoshop
PS现在可能已经都不太用了
是吧
哈
我们读研究生的时候用
作为一个经常做实验的人
我们要经常用这个PS去p实验材料
我不知道有没有做认知的同学
用过PS去做实验材料有吗
现在时代变化这么快吗
哈哈
我们当时
比方说你要去把这个稍微偏一点
就是把比方说把面孔对吧
全部改成一个灰度
那你还得用PS进行改
那么你在PS的时候就有一
就像是每一层图
它有一定的元素对吧
然后它在同一个坐标体制下
你把它叠加到一起
你最后看到的
就是多个图层叠加的结果
那么g Pro two它也用的是这么一个逻辑
就是我其实你看到几张完整的图
它其实内部是有不同的层的
每一层代表着不同的信息
如果你把不同层的信息叠加起来的话
你最后看到的就是一个
非常丰富的一个
呃就是信息非常丰富
也非常好看的一个图
那么另外一个呢
就是它的这个生态
其实是越来越丰富的
也就是说g plot to它本身可能是一个
比方说你呃
你需要进行某种映映色的时候对吧
画这种直方图啊
3点图很简单对吧
但是一些复杂的图的时候
你可能需要写大人的代码
那么这个时候呢
有一些新的包
一些新的函数
他就把那些大量的代码
都直接给你写好
封装好
又再一次的这个画繁为简对吧
有大量的默认值
让你能够去画很复杂的图
呃这个地方的话
大家可以去找一下去看一看
实际上现在几
几乎我们看到的很所有的图啊
基本上都可以这个啊做出来
我们说数据分析的图啊
那比方说像这样的图对吧
他这里又有折线
然后又有阴影
然后还有色块
那么整个来说的话
就是看起来也很美观
你也能够看到这个数据的一个趋势
对吧
然后我们刚刚也在PPT上说
它是一个行业的标杆对吧
行业标杆意思是什么
就是说现在很多的这个
呃
不管是新闻媒体呈现数据的时候也好
还是说你在杂志里面对吧
像顶顶刊上面画图的时
候
它很多时候都是使用这个机器thought
而而且呢
各种各样的数据
它都能够完整的进行重复
比方说你可以把定义的信息对吧
然后和这种时间序列的数据
加上各种各样的这个
这个其他的这种标准的信息
都能够进行非常好的一个呈现
所以呢它是我们呃
就非常值得去推荐的一个工具
那么我们说的它非常好对吧
那么我们接下来
就是稍微简单的讲一下
它的逻辑啊
然后我们来讲它的使用
那么在我们的这个r Stu里面对吧
我们看的数据框
我们通常操作也是数据框对不对
大家可以看到数据框简简单一点的话
就Mate是我们这样的对不对
然后说有3列3列数据对吧
每个数据有不同的行
然后都有不同的数据点对吧
那么g Pro就在画图的时候
第一个就是说
我们要有一个映射的关系
我们怎么把数据把它变成一个
就是可视化的一个元素对不对
然后你这个123对吧
123你是数字
那么你我们怎么举行量化
大家想想在我们不管小学还是初中
我们学数学的时候
123我们会把它放到一个竖标轴上面
对吧 123进行这么一个排列
那么机构就在画中
他首先做的也那是这样一个一个
一个一个事情
就叫我们的数字
先沿着比方说不同的坐标轴对吧
进行排列
之后把数
把数字映射
成为这个几何的这个可视化的元素
把数字变成就是视觉效果
视觉效果
化然后呢
再把它放到一个特定的坐标体系里面
那么这个是
我们通常看到这个坐标轴体系
对吧它在它在那个d卡尔的坐标轴
就是我们说的x轴y轴对吧
那么你把它就是说呃
放到这个坐标轴里面
然后根据它的这个位置进行映射
之后呢
它就成为了一个最基本的图了
这就是我们机器Pro做的
做的一个最基本的事情对吧
就是把数字映射到一个空间当中对吧
然后放到一个坐标轴里面
然后它就成了一个基本的图了
所以这里就会涉及到一个呃
映射的一个关系
就是把数据
比方说我们这里写的就是x等于什么
对吧
x为f那么f的话
它对应的就是我们这个鼠标呃
这个data frame数据框里面的一个列
对不对
然后y等于a对吧
就是它对应的是我们数据框里面
另外一个列
那么也就是
我们假如说是一个二维的数据
那我们就在二维的空间里面
把每一个数值把它进行一个映射
然后呢就形成了这上面的一个一个点
那也就是说像这个点
它只要是在f上面有个值
在a上面有个值
它又对应着什么呢
在这个二维的体系里面
x对吧f有一个值
y有一个值
那么就形成了它的一个独特的位置
对吧
那么然后我们还可以通过这种叫做呃
数字去改变这些可视化元素
它的一些特点
我们刚才说的只是它的
位置对吧
那么只是把位置呈现出来的话
有时候就是信息可能是不够的
比方说
我们还可以去改变它的这个颜色
和这个这个呃
大小对吧
比方说像这个地方
我们还是我们用a作为这个呃
它的大小的一个一个一个标志
然后f作为一个颜色的标志对吧
比方说f的颜色的话
就是数字从小到大
表示是颜色由浅到深
那么大小的话
从小到大就表示你这个可视化的元素
它的这个w看到的这个大小有点不大
对吧那么这样的话
我们假如说f就是从从1到n
它就是从小到大
a n也是从小到大
那么它最后画出来
就是说我们不仅在这个x y轴上面
把它们从左往右
从下往上进行映射
而且呢还根据它们的颜色
就是f值对吧
给它画了不同深浅的颜色
就是根据f的这个这个column
然后呢也根据a这个列
它去赋予了
每一个可视化元素的不同的大小
也就是说
我们可以通过这种
第一个是映射到上面
是映射到不同的空间位置
下一个的是
我们是给不同的这个可视化的元素
改变它们的一个特性
那么可视化的元素
就是我们看到的这个物体
对吧它的大小
它的颜色
这基本上就是它的一个基本的逻辑
那么另外一个逻辑呢
这逻辑it基本听懂了吧
呵
好
另外呢就是
我们既然可以在一个图层上面
进行映射
对吧那么我
们可以在多个图层进行映射
映射完了之后
把它放到一起叠加起来对吧
然后这个最高轴是最基本的
它是有一个默认的坐标轴
就是我们说的那个底卡的空间对吧
就是横横轴和纵轴
然后我们叠加这个标注
我们把一列数据把它预设为这种这种
这个呃直方图对吧
应该叫霸图
呃条形图
对对意思为条形图
那么另外呢
我们可以把另外一些数据呢
意识为这个一个线图对吧
艾瑞巴
那么我把它叠加到一起之后呢
我们最后看到的就是有线图
然后呢有这个艾瑞巴对吧
有这个标
我们说的标准物也好
标准差也好
这样我们通过多层的图片叠加的话
就可以把我们想要表达的信息
都放到上面
所以这是图层的这个元素
所以我们最终看到的可能是
就是右上角的这个图
但实际上它可能有三层图片对吧
尤其是我们在映射的时候
我们可能映射了两个数据
常分别成为两层对吧
一个是这个条形图
另外一个是L8
我们后面会展示
我们通过就在机器board里面
怎么进行映射
首先数据的映射对吧
就是我们把这个数据映射到这个
呃空间里面
那么我们以这个潘金莲的为例啊
就是大孩子潘金莲的里面
我们有这个体温对吧
呃就每个贝士他测了两次体温
然后在基地Pro里面
我们首先进行数据映射的时候
就是用了ASE
就叫做AES Aesthetics
呃
它这个Aesthetics有点是呃美学的意思
但实际上就是
我们如何把数据
转成这个可视化的元素
那么如果说
我们只进行这么最基本的一个操作
对吧就是g blot
用这个g blot这个函数
然后ASE把x轴
呃就是把ten
把时间点于一的这个温度对吧
映射到x轴上面
把时间点2上的这个温度
映射到y轴上面
这个时候已经映射好了
但是呢如果我们来看的话
我们发现它是一个空的对吧
但这空的
并不是代表它没有任何的规律
但是我们可以看到
它的这个x轴和y轴
它其实是
基本上它不是任意的数字对吧
它是我们人体正常温度的一个范围
也算
其实已经把我们这个温度的信息
已经读进去了
给了我们设定了一个默认的
一个坐标轴了
那么这个时候你意识好了
你要把它可视化
为什么元素你还没有说清楚对吧
你只是把这个每个数字
放到某一个特定的地方了
但是你还没有对它进行可视化
相对是说这个时候在r的这个内部
它已经知道哪个数据应该放在哪
但是它因为你没有告诉它
用一个什么样的几何的物体
或者叫做可视化的元素把它显示出来
所以这个时候
你看到的只是一个坐标轴
那么我们比方说
大大家看到我们前面是PE
对吧我们把这个数据通过这个GF了
映射好了
形成了PE
PE的话它是一个空的对吧
那么我们图层叠加就相当于我们形成
了一个底图了
然后我们在下面叠加一层
就是我们把这个数据
通过闪点的方式
通过几何这个闪点的方式进行呈现
那么几何了
这个闪点几何的物体就是GEOM对吧
这match
那么所有的这种以GEOM开头的
都是各种各样的
就是可视化的这种元素
比方说这个point
代表的就是这个呃点对吧
他就是在这个图上面
显显示一个一个的点
那最终就是我们想要的这个闪点
那这样的话
他就把我们这些两个数据映射出来
对吧大家可以看到我们刚刚说GGBO
它一个特点就是化繁为简对吧
实际上我们这里调用了这个函数以后
它其实就用了大量的默认值在里面
为什么点是这么大
而没有更大对吧
或者更小
为什么是黑色的对不对
为什么是圆点
它可不可以三角形的点
这里就
实际上就已经有大量的默认的词了
但是他用我们最常见的
两个黑色的圆点
对吧大小呢
也是比较相对这个图片来说
就是有一定的比例的
这么一个大小来呈现这个图
所以呢我们就可以只用呃
只要你对吧point这个函数
就能够去把这个我们的数据
进行可视化
那然后我们还可以继续添加图片呃
添加这个呃图层对吧
比方说
我们可以我们想要去加一个回归线
对吧看一下他们两个之间的关系
那么这个时候的话
我们只需要加一个叫做Gmsmus对吧
就是对这个他们之间的关系
进行一个平滑的
一个呃处理的
然后呢这个时候他就会
然后你用什么进行表示
他们之间的一个平滑关系呢
由LM这里就是Linear model的一个缩写
那么也就是说我们在这里加一条线
就是一个两者之间对吧
他们呈与线形模型的关系的
这个呃回归线应该怎么加
然后他也有大量的这个末日的指扎
你看到没有
他不仅有条蓝色的一条回归线对吧
他还有黑色的灰色的阴影啊
这个微热的应用呢
还是有一定的透明度的
那么它实际上就是说
通过这种smooth这种方式
对吧然后呢
把我们两者之间的关系
以及他们的
这个就是因为这个估计的话
它是一个
他是一个
就是呃肯定不是完全准确的对吧
所以他有一些不确定性
把这些不确定性呢
也放在里面了
OK大家可以看到
就是我们写的代码
总共加起来也没有很多
对吧但这个是基本上我们想看到的
很多信息都已经呈现出来了
至少我们可以看到
这个数据应该是符合我们的
我们叫make sense对吧
它是在现实生活中是可能会发生的
对吧
虽然说有一些点
可能看起来也有点奇怪
那当然我们可以
比方说不用线型的这个方式对吧
也可以用其他的方式
那么呃以及
或者说
我们可以对它进行分组来进行呈现
对吧我们刚刚说的
我们可以改变这些几何物体
他的这种方式
对吧比方说我们改变它呈现的颜色
我们用两种不同的颜色来表示不同性
别的人他们的这个体温
那么这个时候的话
我们就可以看到有
他自动会给我们加两个啊
加这个这个呃
几条线对吧
大家可以看到可能性别
我们有123啊
可能有男性女性
还有一些没有回答的一些人对吧
那么他也把他标出来了
然后这个时候
我们把那个实木子里面的这个
大家可以看到
我们上一章里面这个离合线
我们是用规定的是呃
MINI BOLD对吧
当我们不用MINI BOLD之后
大家可以看他就自动采用
他默认只是因为一些曲线的关系
来跟你和这个点之间的关系对吧
然后我们在这里的时候代表呢
也是有一个AES鉴定数据的运色关系
以及把这个几何他的这个颜色对吧
用什么来进行表示
这个异色关系先建立好
然后呢我们加了两个呃可视化的元素
一个是点对吧
第二个就是对他们关系的一个
这种礼盒GM smooth
那这就是我们现在是先映射
然后叠加在两个图层上面
那么我把这个讲完了
我们休息下
可能应该休息了
啊
那我们可以看到
这里面其实有很多元素
都是可以操控的
我们这里举一个例子
就是坐标轴和这个图例
这个坐标轴
它就我们这里下面框出来对吧
他整个都是属于坐标轴
有坐标轴
包括这个轴本身
然后呢
包括这一块区域抛出来
都是整个做到头
那么这个做到头里面
它可以又分成其他的
比方说这个TikTok对吧
你这个刻度是什么
每个Tikmot上面的这个label是什么
它的标签是什么
还有你这个做到头叫什么名字
它叫做x内部计划
就是这个坐标轴本来就是一个名字
这意味着什么
我们这些都可以进行调节
如果说就这里面每一个元素
都是可以进行调节的
包括其实这个线对吧
这个线它我们用什么颜色粗细对吧
都是可以调节的
然后另外一个比方说
也是表明我们可以精细进行操控的
旁边的是一个我们说图例对吧legend
那么这一整块区域
我们都可以认为它是legend的一个区域
那么它包括这个legend的名字
图例的名字
然后
它包key
就是说你有哪些取值范围对吧
然后你的这个每个取值范围
对应的这个可视化的元素的
这个东西是什么
对吧就我们
我们刚才是用性别
然后我们把性别进行了一个fact
把它变成了一个因子
然后呢它就是直接以sex sex对吧
就是我们这个legend的名字
但是这个肯定是可以改的
意味着然后呢它有三个取值对吧
然后每个取值有自己对应的
这个可视化的元素
所以这就意味着
我们这些他这里面每一个小的元素
都是可以后面可以进行精细的修改
但是我们因为现在还是在探索数据
配件呢所以我们这这节课
不会强调太多这个如何去调的内容了
我们接下来先休息一下
然后介绍一下我们常见的一些
对数据题
可视化方便题
快速的去了解数据的
一些方法
休息一下
那我们我们接下来的话就就是聊一下
我们这个
在心理学或社会科学当中常见的一些
其实大家之前可能都见过的一些
这个呃通过可视化的方法
来理解数据的一些一些基本的图形
啊那么第一个
对于这个连续性的变量对吧
我们通常是通过这个直方图的
对他进行可视化
那么比方说
我们认知心理学当中的一个反应时间
对吧呃
他就是如果用秒来算的话呢
就是呃零点几秒对吧
0.70.8这样子
到一点几秒这么一个范围之内
那么我们怎么进行可视化
首先就是我们映射的是
这个时候
我们因为是要对它进行可视化
就是对它的这个呃频次啊
相当于是说
它最后呈现一个什么分布对吧
所以我们这个时候映射的话
只需要映射一个值就可以了
就是映射这个反应时间
然后那么大家可以看到
我们在这个代码当中啊
我们使用的是前面tide verse提到的
这个管道操作
对吧把数据放进来
然后一个管道服务
就是把它传输到下面一个函数里面去
作为输入对吧
那么下一个这个函数就是gtplot
那么机器Pro
也就是说它第一个
它的第一个2
根本第一个参数就是数据框
那么我们这个时候就默认的以这个
呃
前面的这个这个数据框做输入对吧
那么这个AAS就是做这个数据映射
那么x等于什么
就是我们用哪一个变量
这个数据框里面的哪一个变量来做我
们的x的这个呃映射的一个呃
一个一个值对吧
然后映射完了之后呢
我们再对它进行一个
就是对这个映射的数据
进行一个可视化
那么这个时候我们用的是
大家可以看到
又是一个GOM开头的一个函数对吧
那么它是his scram
his scram就是代表直放图对吧
那么这个时候我们大家可以试一下
假如说你不输入这个病史的话
他也会给你出图对吧
但是我们自己可能选择一个
病史的数量
就是你在这个直方图里面对吧
你有多少个
类似于这样的一个小的这个间隔
这就是这个病史它的意义
然后我们又加了一个呃
一个c就是说大家可以看到
这个图跟我们之前的图有什么区别
显得更加干净一点对不对
我们可以回过头来看前面这个图
这个图是其实啊
他默认的一个输出对吧
大家可以看他会有这个呃
方格线对不对
我们前面在这个地方对吧
这是我们在r里面输出的图
首先它的它是有方格线对吧
有这个格子
然后呢
它有一个灰色的阴影做背景对吧
那么我们用的这个SIM classic口子后呢
大家可以看到
首先x和y轴它是明显的变
变得更加凸显对吧
第二个
就是它的背景的那个灰色和方格
和那个格子对吧
没有了
那么当然还有一些其他的元素啊
就是这也就是说
我们加了这个SIM Classco之后呢
它就改变了
我们的整个画图的一个风格
或者叫主题
它跟默认的这个主题不太一样了
那么我们后面再讲
那个具体我们怎么输出这种
这种可以用来直接发表的
我们会讲APA的这个SIM
就是我们心理学最常用的这个
美国心理学会的这个格式对吧
那么这里我们可以初步了解一下
这个加了一个SIM之后呢
它的这个整个风格会有一些变化
那么同样我们也可以
前面的是一个直方图对吧
表示平次的分布
这个这个图大家都知道什么意思吧
his Grom对吧
脂肪族它
它代表的什么意思
大家都都能够懂吧
对吧它是表示相对
是
大家可以看到它的外轴是什么对吧
是count对吧
就是有多少个
有多少个技术对吧
相对相当于是在每一个一个区间
在这个区间之内对吧
有多少个数值
所以它代表的是
基本上是一个分布对吧
一个频次的分布
那么对于频次的分布的话
我们可以也可以用另外一个指标
就是它的一个密度对吧
就是假如说我们把它编成一个曲线
这个曲线的面积它是为一的话
那么各个地方对吧
各个这个
这个呃
各个x所对的这个
它的高度应该是多少对吧
那么把它变成一个呃
密度的一个一个曲线
那么我们这个时候要改变的其实就是
呃我们其实也可以把这个ggplot
就是说AES大
大家可以看到
我们这里跟刚才有一点点变化啊
我们也是把它这个反应词
这个数据对吧
整个数据框中一个输入
然后呢直接用了机器plot
大家可以看到
我们这里什么都没有用对吧
然后我们再加号
就是在叠加图层的时候
我们在这个呃
这个density
这个就是密度的曲线的这个函数里面
对吧
我们去补充这个数据的映射信息
然后这个数据映射信息呢
跟刚才是一样的对吧
就是只映射x
然后呢把RT映射到这个x上面对吧
然后
它就给我们画出了一个曲线的一个图
然后我们同样用classical的这么一个呃
呃一个thing
那么大家可以看到
这两个的信息基本上是非常相似对吧
这个曲线的高度
跟我们的这个频次对吧
频次越多的地方
它这个曲线的高度越高对吧
那么这个呃外层呢
就是density
就是这个密度
然后我们也可以把它叠加到一起
那么如果说我们直接叠加的话
我们直接叠加的话
比方说我们直接把这个RT
就是呃平次的那个图对吧
先把它放过来
呃就是把RT ins到x上面
然后呢用hisground去呃
画这个直方图对吧
画脂肪图之后
大家想我们说我们之前说过
这个g flow
可以直接进行图层的叠加对吧
那我们是不是可以直接叠加一层
这个单词的图呢
我们可以尝试一下
叠加完了之后
然后再用这个克拉斯口的这个SIM
去画出来
对吧
最后发现我们没有看到这个曲线
我们肯定可以预期对吧
就是说假如说这个图画好的话
他应该就是沿着这个
直方图的边缘对吧
有这么一条曲线对不对
因为他们俩表示
其实是类似同样一个信息
但是呢实际上我们看不出来
为什么呢
因为大家可以看到他的一个这个
这个外轴的一个信息的一个区别
对吧
这个这个它的它的单位是一二对吧
这个的单位是5001,000
所以有可能它已经叠在上面了
但是呢看不出来
为什么呢
因为它非常小对吧
为什么就是因为这两个
一个直方图和一个单词里
它们的在外轴上单位
其实我们没有保持一致对吧
这个时候我们看到了这个
这个直方图的话
那么这个单词
它实际上就是在一个很小的范围之内
有可能它的整个就是在0到这里
一点点对吧
那么在这么一小的一个曲线里面的话
它有这么一个横
有一个曲线的话
我们基本上就看不出来对吧
所以我们要把他们俩的这个
这两个两种方式的这个坐标改成一致
对吧这里我们可以用这样一种方式
就是说把这个
外轴就是直方图的这个外轴对吧
把它变成一个density
然后呢后面我们就不管画的是history
还是这个density
密度图我们都是画的是
都是以它的这个密度
来作为画出的一个呃
就是映射的这个数据
那么这个时候的话
我们就可以看到
得到了我们想要的一个图
对吧
在这个直方图上面叠加了一个曲线
那么这个曲线就是我们的这个密度
那么
它几乎是表示的是一个类似的信息
对吧
那这个时
候我们在这个地方加了一个代码
它的是主要是什么
就是说我们前面的映射
是把RT映射到x上对吧
我们外侧
其实我们是让它自动的在处理
自动在处理的时候呢
如果我们只画这个黑水管
我们画这个直方图对吧
他自动默认的外轴就是就是计数OK
那么这个时候我们可以把这个外轴
我们自己把它规定一下
把它规定死
就是说
它对RT做一个density的一个处理
所以外轴呢
它全它就变成了一个RT
在不同的这个区间分布的一个密度
OK然后呢
这个时候他映射出来呢
我们不管是用history还是用density
这个曲线
它都是呃一致的一个外轴的范围
所以这个时候两两个图都能够在这个
或者两个信息
都能够在一张图上面进行呈现
那么当然这大家可以后面可以查一下
就是说除了这个afterstates这个以外
还有没有其他的表达的方式
画同样的一个呃图
大家可以去了解一下
那么这个直方图和密度图
它告诉我们的是什么
就是我们可以基本上看到这个
这个我们的RT
在一个这么多对式的反应时间
对吧
它放到起它是呈现一个什么样的分布
它是不是我们是不是说
是不是make sense对吧
是不是有是不是有意义的
比方说我们在这里可以看到
在0.25这个地方
对吧
0.25代表的是250毫秒
那么其实我们可以看到
绝大部分的反应时间
其实都是比较正常
但是
还是会有一些数据是特别快的反应
对吧它不多
但是它是存在的
大家想想我们在学我
我记得应该在实验心理学
还是在认知心理学里面
是不是讲过
人的最快的反应时间是多少
对吧就是你看了一个字立刻就反应
那么你的反应时间大概是多少
基本上会有一个正常的范围吧
对吧可能低于200毫米
可能就是非常非常快的对吧
然后
如果说你的任务稍微复杂一点的话
你要做一点点认知加工的话
那是不是意味着
你要你的反应时间会更长
对吧
所以的话
它可以就可以帮助我们判断
第一数据整体上面
是不是符合我们人类反应的规律的
对吧第二
就是说我们是不是存在一些数据
我们称之为极端数据
可以考虑把它删除掉对吧
那么除了这个呃
这个这个呃曲线
这个脂肪图和这个密度曲线之外呢
我们还可以用一些其他的方式对吧
也可以对这个数据进行一个呃
快速的可视化
比方说呃
我们可以分条件对吧
啊对
不同的条件下面看它
它的反应时间
是不是整体上面
有一个什么样的一个趋势
那么这个时候的话
我们其实可以考虑使用这个呃
叫做镶线图啊box plot
那么box PROS
大大家注意到
我们这个时候想要做的是什么
因为在我们那个就是matching task里面
我们我们根据图图片的这个不同对吧
我们实际上是分成了不同的条件
对不对大家还有印象吗
就是说我们
标的那个图形
他可能是好的自己
可能是好的他人对吧
也可能是不好的自己
也不好的他人
有四种条件
那么还有匹配和不匹配对吧
图形和文字是不是匹配呃
这个这个变量
那么假如说我们就想看这个匹配呃
就想看这个4种条件之下对吧
我们不管他是匹配还是不匹配
这4种条件之下
他们的反应时间
整体上面
会不会有一些明显的一些差异
对吧那么我们就可以通过这个呃
像镶嵌图做一个快速的一个可视化
那么这个时候
然后我们选择的是以label对吧啊
以这个文字
作为一个一个一个分组的条件
我们在映射的时候
我们可以看到
就是把x把label映射到x上面
label是什么
就是我们四种四种条件对吧
它是它字符型的数据对吧
那么对制服性的数据的话
大家想想我把它映射起来的话
实际上就类似把它作为一个
首先把它作为离散的数据对吧
那么大家可以看到
这个时候离散的数据它是怎么处理的
就是在XO上面把它定义为4个
4个点对吧
四个不同的点
每个不同的点的位置
代表的就是一个有点
类似1234对吧
把它当做一个整数
整形的数据来进行处理
它们间的间隔是相同的
然后另外一个就是
当我们把这个label对吧
一个制服映射到x轴上面时候
大家看到它的顺序是什么样的
是immoral对吧
然后other
immoral self然后moral other
moral moral self
这个这个顺序是怎么来的呢
大家觉得
还记得我们之前说
当你对制服机排序的时候啊
你默认的做法是什么
按照Alphabet对吧
就是字母的顺序对吧
大家可以看到这里
我们可以简单对比一下吗
啊首先是这个moral和in moral对吧
i在m的前面对吧
所以说in moral都在前面
然后这两个字符前面都是一模一样的
对吧o在s的前面
所以说大家可以看到就是
它就是按照r里面默认的
这个阿尔法杯的
来进行排序
对吧那么所以当我们把字符形的
字符形的数字
映射到x上或者y字上的时候
r里面是
r内部
是在帮我们做了很多的默认的处理的
他没有跟我们报错说哎
你这个是制服的
你这个是制服
你的数字
你不能够把它映射成为数据
它是直接帮你做了一些处理
首先是给你把它类似于
就是把它当做制服进行一个排序对吧
排序之后
然后给它分配了一个数字1234这样子
然后就映射到了x上面
然后外折
我们这个时候ins是RT对吧
RT的话它就是连续性的数值针
没什么太大问题
那么然后呢
ins完了之后
我们它会这个时候AES对吧
完成了这个数据的意思
意思完了之后
你可以有有很多种方式
来去呈现你的这个结果
对吧
那我们刚刚说我们想要去看一看
初步的看一看不同
条件之间有没有区别对吧
那么
所以我们通常用什么样的一个数值
来表示这个数据的整体的情况呢
均值对吧
或者是medium中位数对吧
然后我们用什么来表示
数据的这个离散的情况呢
我们用比方说这个叫做框tile对吧
就不同这个四分位距啊
或者是全距啊
或者SD之类的一些一些值对吧
那么所以box Pro
它就能够将这些元素呢融合到一起
这样的话让我们能够看到这一群数据
它的一个集中的一个情况
以及它的一个离散情况
然后我们这里的
我们就直接就采用的是这个GM box
大家可以试一下
比方说我把这里面的去掉对吧
它会不会有什么区别
它可能没有
没有太大的区别
然后呢他通过这个Boxport
这么一个简单的一个
我们说一个几何呃物体对吧
geometry这这么一个object
那么它就会给我们呈现
帮助我们处理一些信息
就是首先是帮助
把这每个条件下的
RT的这个中位数算出来
然后它的四分位距算出来对吧
然后呢把它画成一个相线图
然后并且把我们这些离群值呢
也标出来
所以大家可以看到这里的有
因为有四个条件对吧
就有4个box
然后每一个box中间的
是它的这个中位数
然后这是呃上下的这个四分位距对吧
然后四分位数
然后呢
哎这个之外的就把它放大了对吧
就是认为是离群值
那么这这是因为这个呃叫做Boxport r
里面它默认的使用是1.5的这种做法
大家可以看到
这里又体现了
我们在前面讲GT Pro的时候
它的一个就是叫做化繁为简对吧
如果说你自己要去画一个
这么一个相应数的话
你可能得进行一些运算啊
然后把这个数字求出来对吧
然后再把一个一个元素的去映射上去
但GT Pro有个好处
就是说他这些这些就是常用的做法
对吧他经常做
所以说
他就给你集成了大量的这个默认值
你只要一个简单的命令
就给你把这个呃数据的这种
像box four这样的一个可数化
给你做出来
那么大可以看一下
我们这个时候能不能看到
一些基本的一些模式
我们还是可以看到的对吧
比方说这里这个moself
它的这个中位数相对来说是最低的
对吧
然后其次的话好像就是Mora的对吧
然后这两个呢
是比较这个中位数相对来说高一点的
但因为我们这个数据量比较大对吧
所以呢看起来没有那么明显
但整体上还是能够看到这个趋势
对不对
这是一个常用的一个呃相像的图
当然大家也可以用改变这里面
比方说离群值的一个指标对吧
这样的话
对你来说
你的这个数据里面有多少个离群值
对吧啊
甚至我们可以改变这个离群值的颜色
对吧让他以一个高标成红色对吧
很显眼的一种方式显示
显示出来表示你这里面有一些值
有些数字肯定是值得高高度关注的
那么这两这些这些图啊
比方说我们前面看到的闪点图对吧
包括这里的直方图
还有密度图
都是我们常用的
那么还有一个就是
啧啧
啧啧
啧啧
啧啧啧啧啧啧啧啧啧啧啧啧啧啧
啧啧
啧啧啧啧啧啧啧啧啧啧啧啧啧啧啧啧
啧啧啧
直接采用这种啊
就是说你只要一行代码
我就直接告诉你
你这里面是一些呃什么内容对吧
然后有一个新的包呃
叫做daily Explorer
叫数据探索对吧
那么它这里面
就可以画出各种各样的一些图
比方说你只要画
比方说import interest对吧
你可以画一下这个mart里面
它这里面就会有各种各样的
你这个数据占了多大对吧
然后你的discrete column
然后continues对吧
啊还有有多少是完整的啊
有多少缺失值
就是帮你快速的对这个数据框
整体的做一个探索
还比方说
我们可以看到这个
专门去画这个missing values对吧
就是缺失值
我们可以看到这里面表示RT和a C
c没有缺失值对吧
这个response里面
有很有相对来说比较多的缺失值
然后这个缺失值的行是多少
占的比例是多少
还有对他的这个每一个每一个列对吧
进行一个快速的一个可视化啊
不同的值
他的一个
他的一个就是啊
化成这个呃BU对吧
条形图的话大概长什么样
还有像这个呃
通过这种呃
就是以不同的
以某一个特殊的column
作为这个分组条件
对吧来画它是一个
它的比例是什么样的
当然我
们这个选择一个比例
就是基本上都是一样的
大家可以看到
因为我们这个百分之
我们条件设置是一样的对吧
在这些部分
比方说practice
然后呃
每个背时完成的对不对
然后不管是左一手还是右一手完成的
呃图形这上面都是一样的对吧
就就说明一个什么问题呢
就是大部分的试词对吧
都是Mac和MIS
Mac 1:1的它符合我们的实验设计
但是这个response呢
它可能不是1:1对吧
那表示说贝斯的反应
它上面会有一些区别的
还有对于这种hitchprom对吧
这种数字型的他
他也可以快速的给我们
给我们画出来对吧
然后我们刚刚重点看到RT
假如说大家有很多这种这个
这个数字性的数据的话
呃那么多个多一列的
这个这个这个frequency对吧
呃平数图
它一下就可以给我们全部画出来
这样的话我们可以看到各个column
各个列的一个整体的状况
还可以画这个QQ图对吧
看他的一个正态性
这里面我们都稍微展示一下
那么这里也就是说像这个Explorer
daily Explorer
它还是专门为了去探索
快速的探索你这个数据框的呃
这个数据的情况
而是开发一个包
所以他有很多这种非常好用
非常快速的一些功能
包括像这个correlation对吧
如果你是做问卷飞机的话
你肯定这个这个这个结果图的话
对你来说就非常的可能
对你来说非常友好对吧
你可以看到部分条目之间得分对吧
他是不是
出现了你所预期的一个高相关
或者低相关
那么还有g PROS里面
就是说呃
在这个体系之下
他开发出来一些其他的
符合他这个规范的一个
这些包比方说GG pass对吧
哎这里还
他就可以把我们这个数据组成
对了之后
然后直接把他们的关系划出来
这里面就会有他们的呃
一方面有他们的这个相关系数
大家可以看到上面对吧
然后另一方面的话
有他们每个每个数字的一个分布
然后的话还有就是他们这个散点图
比如说这个pass的话
能够给我们这种在探索相关的时候
能够快速给我们的一些既有原始数据
又有统计值
然后有每个数据自身的分布的啊
这么一个一个一个一个数据的结果
它也是帮助我们能够快速的去探索
对吧
那么我们这节课啊
就是内容相对来说没有那么多啊
没有上节课那么多
但是呢
呃强调的一点就是
数据的探索
尤其通过可视化的方式探索
对我们来说是呃
非常非常重要的
嗯
如果大家能够记住这节课开始的那个
那个恐龙
对吧你要知道
在做统计分析之前
我一定要看一下原始数据
不管我用什么方式
对吧
我要看一下原始数据它是不是合理的
是不是靠谱的
那么我们这节课基本上就OK了
那么另外一个的话
我们这节课开始
开始使用机器Pro出来
大家可以看到
我们只是展示了一下
机器Pro的很多功能
并并没有告诉
他每个元素怎么操控
为什么
因为我们还没有到这一步对吧
呃我们相当于是我们整个数据分析
大家回想下我们上课从导入数据
到现在导入数据清洗数据对吧
这一步是初步了解数据
初步了解数据之后我们要干什么
我们肯定要进行统计分析对吧
所以接下来的话我们会接下节课
我们会告诉大家如何用这个啊
做统计分析
但是我们前面讲的内容
我们不会再重复了
那么这这就意味着大家要进行练习
去提高自己的操纵数据能力
开始探索数据的能力
然后
以及把这个前面学的几节课内容
组合起来
然后我能不能通过对数据框的选择
来对他们进行画图
对吧
然后我们能够对数据类型的转换改变
比方说这个图当中的这个元素
呈现的一个顺序
那就是我们的这些
这些可以建议给大家练习啊
然后大家可以对不同的
这个图形的这个机动率
对吧进行分组绘图
然后采用box plot
那么这里基本上
就是要把我们课件中的这个数据
进行替换
OK然后这个集中率的话
大家用上这个数据的话
可能需要去把之前的那节课的数据
预处理当中的那个练习的
把它给用上
对吧大家还记得
我们有一节课的练习
是让大家求这个deep prime
如果那个练习你没有做的话
那么这个练习你就可能就没法完成了
因为你没有集中力对吧
大家可以看到
就是说我们在做我们的数据
是我们的这个叫什么
这个操作
是像跟前面的课程紧密相关的
大家一定要去回过头去
把前面的这个技能再去练习练习
然后第二个就是说
我们把这个图画出来之后对吧
我们能不能按照自己想要的顺序
进行排序
现在的是直接按照阿尔卑的对吧
但是阿尔卑的
不一定符合我们自己的要求
我们如何来按照自己想要的顺序
进行排序
这节课
也是让我们在讲这个数据类型的转换
的时候
数据类型对吧
以及如何转化的时候
我们讲过这个
这个知识点
大家需要去这个这个
去把这个知知识点用上来
才能够画好这个图
然后做散点图的话
这个就是大家可以用这个判断点的
对吧去探索一下你感兴趣的变量
把它进行一些预处理啊
然后呢画一下散点图
然后呢呃
还有一个比方说
我们刚才画的这个反应时间对吧
实际上是所有贝斯的反应时间
但是我们有的时候希望知道的是
比方说
不仅仅是整整体的一个反应时间
对吧我们想要知道
每个贝时的反应时间长什么样子
对吧贝时之间有没有个体差异
那比方说
大家能不能提取出4个贝时
或者5个贝时的数据
把他们的反应时间都画出来
这个大家可能也需要去练习
去打磨自己画图的注意
探索了这个技能
然后最后一个怎么去完成对吧
大家说我们是不是一定要记住代码呢
我觉得我最近看了这个南科大呃
刘雪云老师的这个
他在自己
公众号上写了一个
就是像这种人工智能对吧
和大模型出现之后
我们老师应该怎么办
我有很认同他的观点
就是我们应该教大家
如何更好的去使用
那么大家应该去学会
比方说使用这个大模型
进行精准的提问
然后我自己其实在上课之前
我也就是试了一下
就我参考那个刘学英老师的
我就用的是国内的一个大语言模型
就不用下载GPT了
国内现在有很多这个大圆模型
都可以用
而且有很多是免费的
比方说这个是叫做自负轻言对吧
当然当然也可以问其他的
然后这个是
这是我上课之前我问的一些问题
大家可以尝试
内容类似这样的
比方说我们刚刚说呃
我看一下啊
然后我刚
我们刚刚
必须要在直方图上面加一个密度曲线
对吧我就问他
就是说用GG Pro画图的时候
能不能在直接使用加号对吧
画了一个直方图之后
能不能使用加号来直接加一个密度
然后他告他就告诉我们怎么做对吧
这里直接给代码
你就这个时候就可以去尝试代码
然后你发现哎
这里面是不是有一些他给的代码
你不太懂对吧
你就直接继续问他
这个代码是什么意思
然后他就会给你解释对吧
然后你还可以继续追问他
就是有没有跟这个内饰
就是跟这个写法有同样功能的
一些其他的表达式
对吧他
他也可以给给你一些其他的一些例子
所以总体来说的话
你就会发现
呃这种技术性的
东西对吧
这种知识性的东西
就传统上可能大家觉得哎
我需要死记硬背的
这些东西
现在我们都不需要记了
就直接可以通过这种免费的大模型
都可以获得
然后所以呢
回到我们这个课件的话
就是说
大家需要去学会如何进行精准的提问
如何使用正确的这个prompt对吧
把这个大模型里面的这个数据
给你提取出来
让你所为你自己所用
OK这个是很重要一点
那么另外
大家如果还是想要找一些参考书
说想看一看对吧
那么我们这里也提供了一些链接
有些参考书大家可以去呃看一看
然后我刚刚也强调一点
就是练习的问题啊
那么我们现在我们今天在群里面
主要在群里面发了那个呃发消息了
对吧说我们这个第二次的小小作业
已经上线了呃
大家直接在那个合金平台上面
进行完成
然后我们也发了一个PDF
告诉大家如何去呃去注册
尤其是选课的同学一定要注意
就是为了让我们能够快速的识别出呃
你们来因为我们现在这个课
直接上传到b站上面
对吧
说不定有人在b站上面看了视频之后
也去做作业
做作业大家呢
就是最好按照我们推荐的方式进行
去注册你们的那个合金的账号
然后我们能够快速识别
到底是哪些同学完成作业
然后这个作业是可以反复提交的啊
为什么
而且我们还设置了一个一个门槛
就是你必须要达到多少分数以后
你才能够算算及格
为什么呢
因为这个是非常基本的内容
就大家如果你不会做这个的话
你后面就
我们都不能认为
你是掌握了这个前面的基本的知识
对吧所以呢
呃大家可以就是多
如果说你做错了对吧
呃可以再重新提交
我们不需要知道
就是说你是原创的
写这个代码
你只需要能够解决这个问题就行了
这个代码可以是copy的
可以是从别处
可以是问大模型问出来的
但是你必须得最好是手动的敲进去的
对吧是你自己用你的手指敲进去的
这样的话
你才能够我们说有一个学习的过程
要不然的话
就很难起到一个学习的效果了
OK今天没有这个提示音啊
我也不知道这个
这个是不应该是该下课了
两节课的话
行
那我们今天就到这
大家最好是把课最新的课件下载下来
然后里面提到练习
大家去练一练
然后小作业是一定要做完的
OK小作业是算分的
然后这上面练习都是我们推荐
好谢谢大家
我们今天课就到这里




# 以下是代码部分

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  fig.width=9, fig.height=4, fig.retina=2, 
  out.width="100%",
  message = FALSE,
  warning = F
)
```

```{css extra.css, echo=FALSE}
/* - extra.css - */
.bigfont {
  font-size: 30px;
}
.size5{
font-size: 20px;
}
.tit_font{
font-size: 60px;
}

```





# Packages
```{r}
if (!requireNamespace('pacman', quietly = TRUE)) {
    install.packages('pacman')
}


pacman::p_load(
  # 本节课需要用到的 packages
  here,skimr,quartets,GGally,showtext,bruceR,tidyverse,DataExplorer,
  # 生成课件
  xaringan,xaringanthemer,xaringanExtra)
```



class: inverse center middle
.tit_font[
回顾


???
-   回顾

-   数据探索与描述统计

-   为什么可视化

-   为什么用 ggplot 画图

-   ggplot 绘图的原理

-   基本图形简介
  -   散点图
  -   柱状图
  -   密度图
  -   



## 7.0.1  批量导入数据
```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```



获取地址
```{r }
# 所有数据路径
files <- list.files(  #<<
  ## <- & =
  here::here("data", "match"), 
  pattern = "data_exp7_rep_match_.*\\.out$", 
  full.names = TRUE)
```



数据类型转换

```{r}
convert_data_types <- function(df) {
  df <- df %>% 
    dplyr::mutate(Date = as.character(Date),Prac = as.character(Prac),
                  Sub = as.numeric(Sub),Age = as.numeric(Age),
                  Sex = as.character(Sex),Hand = as.character(Hand),
                  Block = as.numeric(Block),Bin = as.numeric(Bin),
                  Trial = as.numeric(Trial),Shape = as.character(Shape),
                  Label = as.character(Label),Match = as.character(Match),
                  CorrResp = as.character(CorrResp),Resp = as.character(Resp),
                  ACC = as.numeric(ACC),RT = as.numeric(RT))
  return(df)
}
```

批量合并
```{r }
df3 <- data.frame() 

for (i in seq_along(files)) {
  # 读取
  df <- read.table(files[i], header = TRUE) %>%  
    dplyr::filter(Date != "Date") %>%  
    convert_data_types() 
  # 合并
  df3 <- dplyr::bind_rows(df3, df) 
}
# 删除临时变量
rm(df, files, i)
```

保存数据

```{r eval=FALSE}
## NOT RUN
## 上节课介绍了write.csv,也可使用bruceR::export
bruceR::export(
  df3, 
  file = here::here("data", "match","match_raw.csv"))

## 当然，export 不仅可以保存数据，也可以输出模型结果

```

修改列名-rename
```{r}
## 修改第一列列名 Date 为小写 date
df3 %>% dplyr::rename(  ## new_name = old_name
  date = Date
) %>% colnames()  

## 将全部列名都变成小写
df3 %>% dplyr::rename_with(
  ## 将字符向量全部变成小写； ~ 声明这是一个函数，.代表前面的数据(df3)传到.所在的位置
  ~tolower(.)   #<<
  ## 即使用 tolower()对所有列名进行批量处理
  ##
) %>% colnames()

```










???
-   解释 变量赋值与参数接受符号差别

-   代码规范性，R 对缩进换行不敏感

-   export 函数



## 7.0.2  代码书写规范

```{r eval=FALSE}
## 看起来如何？
iris %>% group_by(Species) %>% summarize_all(mean) %>%
ungroup %>% gather(measure, value, -Species) %>%
arrange(value)
```


```{r eval=FALSE}
### 是不是更整洁一些
iris %>%
  dplyr::group_by(Species) %>%
  dplyr::summarize_if(is.numeric, mean) %>%
  dplyr::ungroup() %>%
  tidyr::gather(measure, value, -Species) %>%
  dplyr::arrange(value)
## 有没有自动挡…
```


[

参考链接：[tidyverse style guide](https://style.tidyverse.org/index.html)





## 7.0.2  代码书写规范


```{r eval=FALSE}
## 使用 Ctrl + Shift + A  (cmd+shift+A in Mac) 
## 或者点击 Code > Reformat Code (快捷键冲突)
## 自动增加空格与缩进
## 选中下面代码看看效果，尽管效果有限
## 还是平时养成书写习惯更好

files<-list.files(
here::here("data","match"), 
pattern="data_exp7_rep_match_.*\\.out$", 
full.names=TRUE)
```



[

参考链接：[tidyverse style guide](https://style.tidyverse.org/index.html)




## 7.0.3  数据清洗

### 列操作
-   增加、修改、删除(mutate)
-   列筛选(select & tidyseletion)

### 行操作

-   条件过滤(filter)
-   行索引(slice)

### 数据框
-   列/行合并：
    bind_cols & bind_rows

-   匹配合并：
    left_join, right_join, full_join

-   修改列名：
    rownames or dplyr::rename
    
-   长/宽数据转换：
    pivot_longer, pivot_wider





### 分组计算

-   group_by/ungroup

-   summarise

-   rowMeans or bruceR::MEAN(or SUM)

-   case_when()

-   多列选取：across()


### 字符串(stringr package)
-   str_xxx()系列  


### 函数式编程(purrr package)

-   map()系列，类似 apply() 系列  






class: center,middle


<span style="font-size: 50px;">**第七章**</span> 
<span style="font-size: 50px;">__如何探索数据: __</span> 
<span style="font-size: 40px;">描述性统计与数据可视化基础</span>



class: inverse,center,middle


数据已经清洗完成，下面应该做的是……



查看数据内容？

建模分析？

......





先看一个数据(quartets::datasaurus_dozen)







view
```{r}
quartets::datasaurus_dozen %>%  ## 包中的数据
  head(10)
```

`str()`
```{r}
quartets::datasaurus_dozen %>%  ## 包中的数据
  str()
```


`summary()`
```{r}
summary(datasaurus_dozen)
```


```{r echo=FALSE,eval=FALSE}
## NOT SHOW
## PLOT GIF
pacman::p_load(camcorder,tidyverse,bruceR)
data = quartets::datasaurus_dozen
colors = c('#FF5733','#00CED1','#FFD700',
           '#8A2BE2','#32CD32','#4682B4',
           '#FF4500','#9400D3','#00FF00',
           '#FF1493','#8B0000','#FF69B4','#20B2AA')

orders <- data$dataset %>% unique()
orders <- c(orders[-1],orders[1])

pic <- list()
for(i in 1:13) {
  
    pic[[i]] <- data %>% filter(dataset == orders[i]) %>%
      ggplot(aes(x, y)) +
      geom_point(color = colors[i]) +
      geom_smooth(method = "lm", color = 'black')  +
      labs(title = paste0('dataset:  ', orders[i])) +
      bruceR::theme_bruce() +
      theme(title = element_text(size = 20)) 
}

gg_record(
  dir <- file.path(tempdir(), "recording"), 
  device = "png",
  width = 5,
  height = 5,
  units = "in",
  dpi = 500
)

for(i in 1:13){
  pic[[i]] %>% print()
}

gg_playback(name = file.path(paste0(getwd(),'/pic_new/chp7/'), "dino.gif"),
            first_image_duration = 1,
            last_image_duration = 3,
            frame_duration = 1,loop = F,
            playback = T,last_as_first = F,
)
gg_stop_recording()
```

```{r echo=FALSE,fig.align='center',out.width='50%'}
knitr::include_graphics('pic_new/chp7/dino.gif')
```


```{r echo=FALSE,fig.width=7,fig.height=6,fig.dpi=600,out.width='60%',fig.align='center',eval = FALSE}

### NOT RUN
quartets::datasaurus_dozen %>% 
  ggplot(aes(x, y, color = dataset)) +
  geom_point() +
  geom_smooth(method = "lm") +
  facet_wrap(~ dataset)
```






layout: true
# 7.1  探索性数据分析



了解原始数据的特点，做到心中有数，属于一个更广泛的概念：  
**探索性数据分析(Exploratory Data Analysis, EDA)**
]

> In statistics, exploratory data analysis (EDA) is an approach to analyzing data sets to summarize their main characteristics, often with visual methods (Wikipedia).  


```{r,echo=FALSE,out.width="50%",fig.align='center'}
knitr::include_graphics("https://blog.escueladedatosvivos.ai/content/images/2020/12/main_img.png")
```





进行EDA是为了更加了解自己的数据，从而做出基本的判断，但每一次探索背后都对应着特定的问题。我们可以先从几个基础的简单问题开始:]



-   有哪些变量？
-   变量的类型？
-   变量的分布？
-   变量间关系？




```{r eval = T}
# 读取数据
pg_raw <- bruceR::import(here::here(
  "data", "penguin","penguin_rawdata.csv"))

mt_raw <- bruceR::import(here::here(
  "data", "match","match_raw.csv")) 
```




`head`
```{r, out.width = "10px"}
DT::datatable(head(mt_raw, 3))  # 注：datatable 这里只为了在网页中输出
```

`str`
```{r}
mt_raw %>% 
  str() 
```




## 常用函数


`summary`
```{r,out.width="10%"}
summary(mt_raw) %>% 
  knitr::kable() # 注：kable函数只为了输出
```


`skimr::skim()1`
```{r}
skimr::skim(mt_raw) %>% 
  capture.output() %>% 
  .[1:12]
```

`skimr::skim()2`

```{r}
skimr::skim(mt_raw) %>% 
  capture.output() %>% 
  .[13:24]
```


`skimr::skim()3`]
```{r}
skimr::skim(mt_raw) %>% 
  capture.output() %>% 
  .[25:41]
```

`bruceR::Describe()`]

```{r,warning=FALSE}
bruceR::Describe(mt_raw) %>% 
  capture.output() %>% 
  .[2:17] ## 可以使用 file参数输出 Word
```




# 7.2  数据可视化
## 7.2.1 可视化的重要性


Before we do any statistical analyses or present any summary statistics, we should visualise our data as it is:  

-   A quick and easy way to check our data make sense, and to identify any unusual trends.

-   A way to honestly present the features of our data to anyone who reads our research.


```{r echo=FALSE,fig.width=5,out.width='90%',fig.align='default'}
library(showtext)
showtext::showtext_auto(enable = T)
quartets::datasaurus_dozen %>% 
  filter(dataset == 'dino') %>% 
  ggplot(aes(x,y)) + geom_point(color ='#20B2AA') + 
  theme_bruce() + 
  labs(title = '请记住这只 DINO !!!') + 
  theme(plot.title = element_text(size = 20)) 
```


绘图的方式有很多，如 Base graphics, grid, lattice,plotly...为什么使用<span style="color: red;">ggplot2</span>?




# 7.2  数据可视化
## 7.2.2 为何使用 ggplot2?


* 化繁为简：大量的默认值

* 精准定制：所有元素均可控

* 易于叠加：丰富的信息

* 日益丰富的生态系统 [https://r-graph-gallery.com/](https://r-graph-gallery.com/)



## 7.2.2 为何使用 ggplot?

```{r echo=FALSE,out.width='63%',fig.align='center'}
knitr::include_graphics('pic_new/chp7/exmp2.png')
```



## 7.2.2 为何使用 ggplot?

```{r echo=FALSE,out.width='63%',fig.align='center'}
knitr::include_graphics('pic_new/chp7/exmp1.png')
```




Falster, G., Konecky, B., Coats, S. et al. Forced changes in the Pacific Walker circulation over the past millennium. Nature 622, 93–100 (2023). https://doi.org/10.1038/s41586-023-06447-0




## 7.2.3 ggplot2 的逻辑


-   数据映射



```{r echo=FALSE,out.width='75%'}
knitr::include_graphics('pic_new/chp7/mapping.jpg')
```





## 7.2.3 ggplot2 的逻辑


-   数据映射

-   图层叠加


.right-column[
```{r echo=FALSE,out.width='70%'}
knitr::include_graphics('https://psyteachr.github.io/data-skills-v1/images/layers.png')
```



## 7.2.3 ggplot2 的逻辑


-   数据映射

-   图层叠加

-   Code展示


数据映射
```{r fig.width=7,fig.height=6,fig.dpi=600,out.width='50%',fig.align='center'}
# 以penguin问卷中前后体温为例

p1 <- pg_raw %>% 
  ggplot(aes(x = Temperature_t1, # 确定映射到xy轴的变量
             y = Temperature_t2)) 
p1 ## 坐标轴名称已对应，虽然图片为空
  
```


添加图层-散点
```{r fig.width=7,fig.height=6,fig.dpi=600,out.width='60%',fig.align='center'}
p1 + geom_point()
```
添加图层-拟合曲线
```{r fig.width=7,fig.height=6,fig.dpi=600,out.width='60%',fig.align='center'}
p1 + geom_point() + geom_smooth(method = 'lm')
```
改变映射
```{r fig.width=7,fig.height=6,fig.dpi=600,out.width='50%',fig.align='center'}
pg_raw %>% 
  drop_na(Temperature_t1,Temperature_t2,sex) %>% 
  ggplot(aes(x = Temperature_t1, 
             y = Temperature_t2,
             color = factor(sex))) +
  geom_point() + geom_smooth()  

```


-   映射与添加图层是两个概念，映射后可以不进行绘图

-   图层的添加使用 + 

-   除了 x 和 y，仍然有其他变量进行映射，如 color


## 7.2.4 单个图片的组成

```{r echo=FALSE,out.width='70%',fig.align='center'}
knitr::include_graphics('pic_new/chp7/comps1.png')

```




## 7.2.4 单个图片的组成

```{r echo=FALSE,out.width='75%',fig.align='center'}
knitr::include_graphics('pic_new/chp7/comps2.png')

```

# 7.3 常用图形



## 直方图

对于连续变量，我们可以使用直方图进行可视化。
以认知实验中被试的反应时数据为例。




```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
pic_his <- mt_raw %>% 
  # 确定映射到x轴的变量
  ggplot(aes(x = RT)) + 
  geom_histogram(bins = 40) +
  theme_classic()
```

```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='100%',echo=FALSE}
pic_his 
```




## 密度图

同样的我们可以使用密度图来描述反应时的分布情况。



```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='50%'}
pic_dens <- mt_raw %>% ggplot()+
  # 绘制密度曲线
  geom_density(aes(x = RT)) +
  theme_classic()
```




```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='100%',echo=FALSE}
pic_dens
```



## 直方图 + 密度图


```{r eval=FALSE}
## 尝试将两个图层叠加在一起
mt_raw %>% ggplot(aes(x = RT))+
  geom_histogram(bins = 40) + 
  geom_density() +
  theme_classic()
```


```{r echo=FALSE,fig.height=3.5, fig.width=6, message=FALSE, warning=FALSE}

mt_raw %>% ggplot(aes(x = RT))+
  geom_histogram(bins = 40) + 
  geom_density() +
  theme_classic()
```
似乎密度曲线没有显示…
原因在于密度图和直方图Y轴单位并不相同，其实已经映射上了，
如果仔细观察 x 坐标轴还是能看到细微差异的。





## 直方图 + 密度图

```{r fig.height=3.5, fig.width=6, message=FALSE, warning=FALSE,out.width='100%'}
pic_mix <- mt_raw %>% 
  ggplot(aes(x = RT,
  ## 直方图的统计结果通过after_stat(density)传递给了密度图
        y = after_stat(density))) +  #<<
  geom_histogram() +
  geom_density() +
  theme_classic()
# 设定绘图风格
```



```{r fig.height=3.5, fig.width=6, message=FALSE, warning=FALSE,out.width='100%',echo=FALSE}
pic_mix
```



## 箱线图

除了单个变量的可视化，我们可以尝试将两个变量的关系可视化。这里我们利用箱线图看看不同Label的RT如何。



```{r fig.height=3.5, fig.width=6, message=FALSE, warning=FALSE,out.width='50%'}
pic_box <- mt_raw %>% ggplot(aes(
  x = Label,
  y = RT)) +
  geom_boxplot(staplewidth = 1) +
  # 绘制箱线图并添加上下边缘线
  theme_classic()
```




```{r fig.height=3.5, fig.width=6, message=FALSE, warning=FALSE,out.width='100%',echo=FALSE}
pic_box
```

矩形中间线为中位数，上下两条线分别为上四分位数和下四分位数；
1.5个四分位距(Q3-Q1)以外的值为离群值；geom_boxplot默认使用1.5IQR


# 7.4 Explore data with DataExplorer

```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='80%',eval=FALSE}
 DataExplorer::plot_str(mt_raw)
```

```{r echo=FALSE,out.width='65%'}
knitr::include_graphics('pic_new/chp7/plotstr.png')
```



```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
DataExplorer::plot_intro(mt_raw)
```




```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
 DataExplorer::plot_missing(mt_raw)
```



```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
 DataExplorer::plot_bar(mt_raw)
```



```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
 DataExplorer::plot_bar(mt_raw, by="Match")
```



```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
DataExplorer::plot_histogram(mt_raw)
```




```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
 DataExplorer::plot_qq(pg_raw[,2:10])
```



```{r fig.height=4, fig.width=6, message=FALSE, warning=FALSE,out.width='70%'}
DataExplorer::plot_correlation(na.omit(pg_raw[, 2:30]))
```


## 使用ggpairs


```{r panelset=TRUE}
## 以 penguin project 数据中 ALEX, stress和 ECR 为例
pg_raw %>% 
  mutate(
    # 计算均值
    m_ALEX = bruceR::MEAN(.,
      var = 'ALEX',items = 1:16,rev = c(4,12,14,16)),
    m_stress = bruceR::MEAN(.,
      var = 'stress',items = 1:14,rev = c(4:7,9,10,13)
    ),
    m_ECR = bruceR::MEAN(.,
      var = 'ECR',items = 1:36
    )
  ) %>% 
  select(contains('m_')) %>% 
  GGally::ggpairs()
```


#练习

1. 读取match数据，对不同shape的击中率进行分组绘图，可使用boxplot观察差异。

2. 在上一题中，如何按照特定的顺序来展现 boxplot，比如按照moralSelf - immoralSelf - moralOther - immoralOther(提示：设置因子)

3. 读取penguin数据，选择自己感兴趣的两个变量进行处理并画出散点图。
 


#探索

1. 在本章的例子中，我们举例了反应时的分布。但其实我们是对所有被试的所有反应时绘制了总的分布，那么我们能不能找到一个办法绘制出每一个被试的反应时分布呢？

2. 学会使用大语言模型进行学习，进行精准地提问。



# 参考阅读

-   [R Graphics Cookbook](https://r-graphics.org/)

-   [ggplot2: Elegant Graphics for Data Analysis (3e)](https://ggplot2-book.org/index.html)


