
editor_options: 
  markdown: 
    wrap: 72

# 以下是课堂语音转文字


我们前面学的
就是相当于
一方面能学习r的一些基本的知识
对吧另一方面
是用r代码
来帮助我们解决我们统计
课本当中那个描述性的统计
那大家知道我们在做数据分析的时候
或者我们在研究当中
更多的是用r语言
帮助我们去做统计推断
对吧
啊大家如果还记得的话
在学心理统计的时候
有一部分叫描述统计
另一方面叫做推断统计对吧
我们利用我们的数据去做统计推断
那么更多的时候
我们是利用阿源来帮助我们做推断
那么从这这节开始的话
我们就开始呃
使用啊里面的一些工具
帮我们去实现我们的统计推断
应用我们的一些统计知识
那么在这个过程中
大家会发现两点
一个就是r语言的话
他是能够更灵活的
帮助我们实现各种安全方法
那这个灵活呢
他有好处也有坏处
我们可能会在看到这个Lova的时候
会发现好处就是有有很多选择
坏处也是你有很多选择
你不知道怎么选对吧
呃
但是如果说
我们经过了
刚开始那个不知道怎么选的
这个阶段之后
后面可能就是能够更多的呃
使用更
下面是把统计知识
能够更好的进行一个实现
那么另外一个呢
我们会在接下来几节课当中
如果大家还记得我们大纲的话
我们都是说回归模型对吧
回归模型一回归模型2回归模型3
那么为什么是回归模型呢
因为呃
我们也想趁这个阿克的这个机
会呢就是把大家平时呃
在我们心理学好社会科学中呃
这个研究当中也好
我们使用到的一些常用的统计检验
把它统一到这个回归的框架之下
那么这个呢
也是最近呃一些这个研究者
他们所推荐的一种做法
就是实际上
我们心理学使用的这些统计方法
他跟其他学科使用的统计方法
并没有本质上的区别
对吧只不过大家的偏好的问题
那么我们心理学当中使用最多的啊
就是各种各样的
这个回归模型的一个特例
那么我们还是以研究问题作为一个呃
开始那么我们之前对吧
在一开始的时候
介绍我们的数据的时候
我们说到那个人类企鹅计划
在这个人类企鹅计划当中
有几个关键的变量
一个呢是这个恋爱状态对吧
那么还有一个呢
就是核心温度
还有一个呢
是呃这个社交的复杂程度
还有一个是这个赤道的距离对吧
那么有可能
我们刚开始做这个数据分析的时候
我们并没有特别明确的一个假设
那么我们想要知道
假如说社会关系
它有助于我们进行体温调节的话
那么像亲密关系这样的一个很明显的
对成年人来说很重要的一个
这个这个呃社会关系对吧
他会不会影响我们的体温
会不会呃
就是说
能够帮助我们去调节这个核心的温度
那我们可以就是说做一些探索对吧
用我们所知道的一种方法
那么另外就是
这个恋爱状态
他会不会和赤道的距离之间有这个交
互作用
那么为什么我们要
讲这个对吧
那么这有一个图片啊
呃没有更新上
呃
大家还记得那个一个中介模型对吧
这边是呃社交的复杂程度
最左边的
然后右边的是这个核心温度对吧
它中间就有一个跟赤道之间的距离
对不对
呃这三个变量
也就说呃
我们呃应该是最左边的
是距赤道的距离对吧
呃就是你隔赤道越近的话
你的核心体温应该是越高的
因为你在热带嘛
那么你在寒带的话呢
这个时候呃
你的体温
应该来说就是相对来说比较低一点
那么呃house们他的那个研究的就发现
呃社会交往的这个复杂的程度对吧
他会调节这两者之间的关系
他还接那个中介模型对吧
而那个调节模型
然后呢他又发现
在呃不同的这个
这个亲密关系的这个群体当中呢
这三个变量之间的关系是不一样的
对吧所以我们在前面几节课的时候
有两个这种三个变量之间的关系图
大家如果还还记得的话
所以呢
我们就回到这个比较关键的这些概念
然后呢
呃做一些我们常用的一些统计
这个就包括t test和Lova
对吧方在分析
然后呢我们也会介绍test和LOGO
为什么
他们实际上是限时回归的一个呃特例
那么这里研究问题的话
呃
这里因为下载的这个有一点问题啊
那么我们这个第一个人的问题
title
实际上就是我们这里说的在恋爱状态
在这个判断这个数据当中恋
爱的状态
会不会影响我们这个核心的体温
也就是我们会比较两组不同的人对吧
他们的核心体温是不是一样的
呃
因为我们下面这个恋爱状况的话
基本上就是我们可以把它分成两种
一个就是处于恋爱状态之中
或亲密关系之中
对吧另外一个呢
就是不处于这个亲密关系之中
所以我们就把它把所有的数据呢
分成两组
分成两组之后的话
我们要比较他们之间是不是有差异
的话那么很明显
大家都会想到独立亚的t检验对吧
这个都是我们学过的吧
那么我们比较两组数据
他们在某一个硬币量上是不是有区别
的时候我们通常采用的是t检验
对吧
这个应该态度没什么问题啊
当然
我们这里会有一些基础的知识对吧
比方说呃独立亚门体检验
那你需要满足这个正态性
我们可以假定
两个数据都是来自于正态的总体
对吧那么我们也知道
如果说样本量足够大的话
即便他不严格的服从正常分布呢
结果也是呃用体检也是没有问题的
然后另外一个就是方差的这个同质性
对吧啊
他这两个样本的方差应该是呃内饰的
然后两个样本应该是独立的等等等等
然后我们的零假设呢
就是说这两个独立的样本
他们在某一个背面上的均值
是没有差异的
MU1等于MU2
那么我们的背则假设就说
他们的这个呃
群体的均值是有差异的
对吧然后就是MU1不等于MU2 然
后这里是t值
我们做t检验的时候通常的一个公式
这个为什么不能隐藏
那么我们
如果说要做t检验的话
在r里面如何实现
首先我们要做我们之前的呃
在之前的课上学到的那些知识点对吧
就是把数据进行一个预处理那么
这里的这个数据预处理
应该是我们之前都已经学过的代码
对吧就是用Bruce r去import
然后我们这个pumping data
然后呢呃
这里我们就因为原来的数据里面
可能没有背时编号
对吧
我们就随机的生成一个背时编号
然后呢
我们选择自己在本次分析当中
比较关心的问题
比方说我们就像之前选择了对吧
用DPR YR的这个函数
选择了一些我们感兴趣的变量
然后呢
这里就是我们可能有的时候
大家如果不注意的话
会出出错的一个地方
呃
如果说你对某几个呃数据感兴趣的话
你可能要去查看他的缺失值的情况
对吧我们上节课
在讲这个数据的探索的时候
我们讲的这个缺失值
那么作为一个初步的分析的话
你可能就是
我就不管这些确实是什么情况对吧
我先把它去掉了再说
这样的话
能够让我快速的看查看这个结果
然后呢我们可以把这个romantics这个
这个变量对吧
就是呃是否处于亲密关系之中
我们把它变成一个呃fat
变成一个因子
然后呢给他有两个呃有两个水平
一个是恋爱
一个是单身
然后我们这个
时候要感我们感兴趣的音变量是什么
是呃背时的这个温度对吧
就核心的体温
是不是在两组之间有区别
那么怎么得到两组
这两组被是他的一个核心体温呢
我们知道在那个原始数据当中
是有两次测量体温对吧
所以我们这个时候呢
做了一个很简单的处理
就是每个背式的皮核心体温
实际上就是他两次测量的一个呃
一个得分呃的均值
所以我们这里之前也用过对吧
我们用mutate
然后呢生成一个新的变量
这个新的变量呢
是等于呃
以temperature这个字符串开头的这些列
对吧这些columns
那么这些columns实际上就是两列对吧
一个是temperature one
呃temperature t one
一个是temperature t two对吧
然后呢把它们求一个均值
那么这个时候
就得到了我们这个温度的一个均值
对吧那实际上后面的
好像暂时跟我们的目前的分析
没有关系
我们可以先不管他
那这就是我们之前的数据
预处理的一些呃代码
对吧
然后如果说要说t test的话
那么大家可以简单的去问一下
搜索一下
或者问一下大约模型对吧
大约模型很快就会推荐
最常用的这个呃
t test的一个函数
那就是呃t test
t点test那么t点test它是啊
安装的时候你就自带的一个包
叫States啊
就统计这个包里面它带了一个函数
那么这个时候我们就可以
比方说第一个argument
第一个参数对吧就
是我们data等于这个
我们之前的这个
经过筛选的这个数据框
然后temperage啊
就是我们感兴趣的一个自变量对吧
然后romantic就是这个分组的变量
然后这个地方
假定他们的这个方差是相等的对吧
然后我们输出一个结果
那么这个时候我们看到他的这个呃
结果是这样的
t等于0.34
呃664对吧
d f等于142
呃1425 非常大
然后p值呢
是不显著的
然后这个时候我们也可以看到
恋爱状态
对吧恋爱组的和非恋爱组的
他们的这个体温的一个差异
均子差异
确实好像差别不大对吧
那当然
这个大家可可以很快的就用这个呃
就比方说
大家收入大大模型也能够解决
对吧那么为什么我们说它是一个呃
特殊的线性回归的模型呢
那么我们主要是大家可以看这个代码
那么我们在这里是采用这种方式
来去写这个代码
对吧就是把字变量放在前面
把呃因变量放到后面
那么这种方式
实际上跟我们在阿里面写
这个回归模型
是非常像的
那么既然我们说
这个体检
也是一个特殊的回归模型的话
那我们肯定要简单的说一下
回归模型到底是什么对吧
那这个
我相信大家都都应该在考研的时候
都已经学过了
那么在心理统计学里面也都学过了
一般来说的话
我们就是用回归分析的话
呃用用来研究一个或者多个变量对吧
他能不能预测或者解释另一个音变量
对吧
呃我们把这个一个
用来预测另外一个变量
叫做预测变量或自变量
对吧那个被预测的就叫做音变量
或叫做响音变量
在不同的学科可能有不同的叫法
那么线性回归的话
它的核心就是说
我们通过啊
在这两个数据之间对吧
我们拟合一条曲
一条直线
那么这个直线尽可能的能能够
它和每个点之间的这个距离
都是最小的
对吧那么这样的话
能够帮助我们啊完成这么一个预测
当线性回归如果要讲的话
展开讲的话是非常多的
我相信就是说
大家是对一些基本的线性回归的知识
是有的
比方说当我们看到这个y等于杯的0
对吧加上杯的1X1加上杯的2X2
然后最后加上一个x龙对吧
一个误差项的时候
基本上
我们很多时候用这样的一个方程
或一个等式
来表达这个回顾模型
对吧这里面的y就是我们关心的
或说我们把它放在这个等号右边
左边的这个自变量
呃因变量
然后后面的X1 X2一直到n对吧
它都是这个自变量
那么
我们以前在学这个回归模型的时候呢
我们都是学的是叫什么
连续变量之间的关系对吧
就是h呢
它是一个连续的变量
然后y呢
它也是一个连续的变量对吧
它这里跟我们的这个t test
好像不太一样
对不对我们t test好像外是
比方说我们回到这个体温的这个
这个情况
对吧在我们数据清理的时候
我们可以看到
哎
大家可以看到体温
这里它是表示两次体温的一个均值
的话
它应该也是在表示3637左右的一个数值
对吧
我们可以把它视为一个连续变量
因为小数点后面会变化
但是对于我们这里的这个质变量
是不是属于亲密关系
它很明显不是一个
不是一个
这个呃连续的变量对吧
所以它好像跟我们的这个回归模型
有一点区别
但实际上呢
呃这个独立亚门体检
就是我们刚提到这种体检对吧
它实际上就是
这个线性模型的一个特殊的形式
就当我们自变量是二分变量的时候
我们其实也可以把用它来做这个呃
回归
那么他的这个回归呢
呃
有点像是这样啊
因为我们这个图片有点问题啊
这个好像
这好像没有
没有粉笔吗
我们通常看到这个线上的
听可乐就不好意思了
然后我们这里边有一个
呃
这个就是亲密关系
就比方说是处于亲密关系中的
对吧
这个属于不处于亲密关系当中的
单身的状态
那么我们看到的这个体温可能是
比方说是这样的一堆点
对吧
那么这里可能也是一堆点
那我们在做这个线性回归的时候
实际上我们画一条线
实际上是在这两个之间
画一条一条回归线
那么去对他们进行预测
就是当x等于一的时候
对吧我们预测他是他的
他的数值是什么状态
那么当x等于2的时候
我们预测他的这个数值是
这一堆数据的人的均值
是什么状态
那么我们以前的话
现在是我们以前在做回归
回归的时候对吧
我们可能有很多点对不对
那么都在x o上面
然后有一条有一条
这个有一条直线穿过上面对吧
然后我们说x等于这个这个值的时候
那么它预测的y是多少对吧
啊
可以在他附近有另外一个x对吧
他也会对应一个y的预设值
那么也就是说
在我们以前的学习的这个连续数据
做回归的时候
x都可以有很多值对吧
y也有很多值
这是我们所熟悉的
那么在t这个状态之下呢
x它就只有两种取值了
一个就是一
一个就是2对吧
或者一个是零
一个是一
大家可以这么理解
那么我们所做的预示就是
当x等于一的时候
就是当倍式
它属于某一个亲密关系状态的时候
对吧他所对的体温是多少
那么当他处于另外一个速度的时候
他的体温是多少
我们也是在用回归去做预测对吧
所以这个时候
我们的这个独立样本体检验
它就是我们的
这个线性模型的一个非常特殊的形式
就是当我们的这个呃自变量
它是一个二分变量的时候
那么这个
呃
我想想啊
在啊里面的话
实际上对于这个
我们如果说用代码来看的话
我们一会直接直接跑代码了
就是这个
这个就不看了
我们发现不管是我们用这个t test
还是用限制回归
它的结果应该都是一模一样的
我看下
我这边同步好了没有啊
这边还是有稍微有点问题啊
我们把前面的这个代码稍微跑一下
大家应该能够看到呃
我们这里的结果它是完全一样的
神经预数据的预处理
这个大家应该都没有什么问题
然后我们直接看这个t test
假如说我们不看这个
对他的结果进行整理之后呢
我们只看他原
比较原生态的一个输出的话
他是这么一个状态
他会输出这个t等于多少
然后d f值等于多少
p值等于多少对吧
然后我们刚刚说它是一种特殊的回归
那么回归模型的话
在r里面呢
它是有一个很常用的一个函数
如果大家在大大模型里面问这个做
怎么做回归
对吧
那么最常用的这个回归模型就是LM
我们现在看一下这里t值和DF值
还有p值对吧
然后我们可以看一下在这个回归里面
它是不是一模一样的
我们这个地方大家可以看到
我们用的是spacelm这个这个代码
那么这个代码的话呢
它呃指的就是这个线性回归Limi model
然后我们这
这里数据还是采用这个Panga的数据
对吧
然后formula就是回归模型的这个formula
那么这里的话
temper就是我们的前面讲的
一个回归公式里面的y
对吧然后相对是y等于呃背带0
然后加romantics就是我们的x对吧
那么这个x它是一个因子啊
它是一个因子
对吧我们请把它变成一个因子
我们实际上写了这么一个公式之后
只要是把前面的这个因变量
加上一个波浪号
对吧然后加上一个自变量
然后呢
这个LM或者r里面
它就会自动帮我们来处理
解决对因子怎么进行回归分析的
这些后续的一些处理
那么它就会给给我们一个结果
那我们可以看到它这里就是会呃
把这个代码对吧
会给出来
然后呢会把一些v z 9对吧
长插的这个给一些值
然后更重要的可能是
我们这里的这个值
对吧大家可以看到
这个t值跟跟我们刚才的
另外
我们主要是看单身的一个影响对吧
所以呢这个地方的t值0.3十七对吧
p值是0.729
那么跟我们上面的
基本上是一模一样的
对吧 0:37他有一个四舍五入
然后呢0.729
然后我们看回归的
可能前面还有一个intercept对吧
intercept我们一般不会管
那么也就是说对于我们这种情况
对于我们现在看到的这种情况
在t test里面我们看到的是一个值对吧
我们会会说哎
这个呃分组有没有影响对吧
两组之间有没有差异啊
但是在这个呃回归模型里面呢
他这个时候是不太一样
回归模型
我们假如说只有一个自变量的话
我们他我们会看到他有一个intercept
对吧有一个slope
那就我们在这里看到的
假如说我们把这个地方呃
变成一个x和y什么的话
这个intercept类似于就
是它和外层的一个交界点对吧
slope就是这个呃这个斜率对吧
这个斜率怎么理解
它就是当x变化一个单位的时候
那么我们的外会发生多少变化对吧
那对于我们这种
只有2分变量的这种自变量
这种情况来说
我们自变量x
从一个单位变到另从变化一个单位
对吧
它首先就是从一一组跳到另一组
那么我们从一组跳到另一组的时候
我们对应的y的变化
它是不是实际上就是两组之间的差异
对吧
因为我们这里只有两个取值嘛
x只有两个取值
从一组变成另一组对吧
我们这里的这个stop表示
就是我们从一组到另一组基因
当我们的x从对吧
变成一和变成2的时候
它增加一个单位
那么这个时候y值对应变化多少对吧
它首先就是这个
这个地方对吧
那么这个地方就是slow
它实际上就是两者之间的差异对吧
所以比如说我们二分变量这个t test
它对的回归模型
就是关注的是这个回归系数对吧
这个回归系数
它的这个统计简易值
跟我们的t test是完全一模一样的
这也是我们希望展示的这么一个结果
所以我们以前看到的
我们常用的
心理学生常用的这个t test对吧
它实际上就是一个呃
就是一个线性回归
的一个非常特殊的情况
那当然这里会设计了一个知识点啊
我没有仔细的展开讲
但大家以后感兴趣的话
可以去看
就是说呃
我怎么去编码这两个水平对吧
因为我这里有两个值
我们肯定有几种编码的办法
至少
比方说一个是把它把这个编为0对吧
这个编为1
那么比方说y等于这个倍的0
加上倍的一
乘以X1 对吧
那么这个X1的话
它实际上就有两种取值
一个是0一个是一对吧
那它等于0的时候呢就
比方说x等于0的时候
Y3就等于背了0背了0了对吧
然后
y x等于一的时候呢
它就等于背了0加上背了一对吧
所以这个时候大家可以看到
背了一就是两组之间的区别对吧
当然这是一种我们方便
我们理解的一种方式
那么另外一种常用的方式
去怎么编码呢
就是比方说我把S1编码为0
负的0.5和正的0.5
那么这个时候的话
呃对这个杯鸟的解读他又不一样了
大家可以同样把他带入之后
自己去看一下
我们这里就不细致展开了
因为我们呃
主要想跟大家去提示这么一个概念
那么大家可以在啊里面去呃
多探索探索
那么同理的话呢
一系列的整个t test的这个系列
它基本上都可以认为是回归模型的
特例
比方说我们说的这个单样的t结对吧
呃单样的体检我们很平时很少做啊
对不对但有的时候我们也会用
就比方说我们说这个某一个某一组
对吧它是不是某一个数据对吧
比方说我们说这个呃某一半的成绩
它是不是属于呃跟
全校的这个
这个成绩是属于同一个总体对吧
那么我们就相当于是认为
这个班的这个数据
他的均值是不是等于我们
比方说
全校的这个总体的这个均值成绩
对吧
那么我们现在就是把这个班的数据
均值和另外一个均值
一个固定的数值进行比较
因为全校的成绩
我们不可能把数据全部拿来
我们只有一个均值对吧
那么这个时候
我们其实就是做在做单样的体检验
那么在单样的体检验当中的话
比方说我们这里就是呃
全体背式的这个核心温度
它是不是等于一个特定的值
比方说正常人的一个温度对吧
那么它当然这是t值的一些计算公式
我们可以不用不用管它了
那么在单MT键的时候
我们实际上呃就是看这一群数据的值
它是不是
它的均值
是不是等于某一个特定的值
这个时候我们其实就没有描图
大家后面
大家在自己电脑上
应该可以看到这个更好的图啊
我这里应该是有个图的
大家如果在DJ上下下载了
我这个特定的话
应该在电脑上能看到我们这里有个图
那么这个图就是说我们这里有一群点
对吧
那么比方说这个时候我们想比较这个
这个值它是一条线对吧
那么这一群点它的这个均值
比方说我们这里是一个菱形的话
这个菱形它是不是就是跟这个
这里的这个线
是有显著性的差异
或说这个菱形和这个线
它是不是来自同一个总体对吧
那么这个时候的话
我们在他是属于一种什么样的
特定的一个回归模型呢
啊就是只有一个
只有一个背带0的一个回归模型
比如说我们前面讲的是说呃
y等于背带0加背带零一加背带2对吧
那么他
当我们没有这个单样的体检的时候
我们就没有这个东西了
我们就只有YS的一个来历对吧
然后你也可以去做这么一个呃
回归的分析
那这里的话我们也有这个代码
那当然这个时候
我们做做统计检验的时候
用回归模型做统计检验的时候
我们稍微有一点点
这公式稍微有一点点变化
就是说我们这个temperature
就是我们这个呃应变量
对吧它减去30
减去这个我们想要比较的这个值之后
它它的均值实际上就是说是不是属于
我们可以这么认为
就是他的这个这个剪掉了之后对吧
他是不是属于一个正态
一个正态分布
以宁为君子的一个正态分布
那么后面这个一的话
表示我们这个回归模型加了一个洁具
我们做t test的首单
我们就可以直接用x和Miu对吧
和特定的一个字进行比较
那么配置样本体检的话呢
我们其实是把它还原成了一个单
样本体检
如果大家在学统计的时候有印象的话
因为配的样本体检
它是一一对一对的对吧
所以我们可以做一个比较简单操作
就是我们可以把两个数据相减
把两列配对数据相减了之后
我们得到一列数据对吧
然后
我们再把这一列数据当作一个呃
当作一个
就是单样本体检验来进行检验
这个前提的条件啊什么的
我们在这里就都不说了
所以一个简单的办法就
就就说对配置样本体检
一个简单的办法是
我们先用两个
就是两个值相减对吧
减完了之后
他们这个差值是不是呃
比方说跟0是不是相同的
如果说跟0是相同的话
那么我们就认为呃
他们之间是没有差异的对吧
如果说他们的这个差值的分布
很明显跟0不一样的话
那么我们就可以认为呃
他两者之间的这个差异是显著的
那么我们之所以能够这么相减的话
是因为就相当于每一个倍数
它有两个数据点对吧
它完全是配对的这种数据情况
但是我们一般
对于这个独立样本体检的话
因为呃他没有形成一个配对的关系
所以我们不会用直接相减的方式
因为我们不知道谁跟谁是配对的关系
对吧但是对配对样本体检的话
我们可以这么去减
那么同样对于配的MT键的话
大家可以看到
就是我们这个又回归的做法
是很简单的啊
跟刚才的独立MT键也是一样对吧
就是用啊对
就很类似吧
也不能说完全一样
就他们是1T1减去T2对吧
因为它和T1和T2之间的一个关系
它是完全配对的
所以它最后剪完了之后
就形成了一列数据
那么最后这一列数据
它的均值是不是等于0
呃然后对于这个playdmt型在r里面实
现的话呢
呃我们一般还是用这个t点test
就可以实现
呃我们直接就是把两列数据分别用x
y输入进来对吧
然后把这个Pad等于two
就是说他们之间是配对的关系啊
这么写一下就可以解决这个问题
当然
我们前面讲的是说通过这个我们嗯
就是说感兴趣的一个小的问题
亲密关系
和不在亲密关系中的这两群人
对吧
他们在身体温度上是不是有区别的
在总体上面
然后呢我们可以用佩利亚的体检
对他进行来进行检验
然后我们发现
就是说配比MT检验它是一个特定
它是一个很特殊的一个回归模型
对吧那么我们也可以同样可以发现
对于所有的其他的这个test来说
它们也是特定的一些回归模型
但是呢
我们可能有的时候在自己做研究中
我们还是大部分情况下吧
对吧我们还是在使用这个
我们心理学习惯的这种体检
对吧那么这个时候呢
如果说前面讲的是
为了方便大家去理解
t test和线性模型
它本质上是一样的
那么这里我们讲方便大家使用
就是使用这个Bruce r的t test
呃这里面应该是有一个主
关于布鲁萨的t test
里面的
各种各样的这个参数的介介绍啊啊
大家如果下载了我们这个科技的话
可以看到布鲁萨的这个呃
它基本上涵盖了我们所有的t test
然后它的输出呢
也是非常方便的呃
它输出的应该是
直接是一个三线表
那么我们所有的结果跟
就是说不管是独立am提前
还是配立am提前
还是Diam提前对吧
在这个fruits r里面
我们都可以发现
它跟这个r base里面的这个自带的包
titas是一模一样的
也就是说
它跟现行回归模型
得到结果是一模一样的
对吧
那么最后做一个小的总结
对于这个t test的话那么
它对于这个r字带的函数来说
都是这个t test对吧
我们用的稍微
就是说这个语法稍微有点不一样
那么线性模型的话呢
单m t结就是y对吧
然后这个公式是直接是只有结句
然后独立
要么提前的话
就是结句加上一个旋律对吧
就是然后呢
对于这个呃配置样本体检呢
就是Y1减去Y2对吧
它们嗯在这个差值只有一个结句
所以它可以可以理解
它是一个仅有结局的一个回合模型
那么独立样本体检呢
也是一个仅有结局的回合模型
那么对独立样本体检呢
就是自变量为2
分变量的一个回合模型
嗯
那这里要把这个
就是说
仅有洁具的回归模型是一个什么东西
对吧要讲清楚的话
可能还要回到这个正态分布啊
这些东西
好了抽样分布这些东西
呃就是为什么这个抽样分布
或者为什么我们用这个t
t字这个分布
对吧可以来做这个事情
呃但是我们没有时间去展开啊
那么大家后面感兴趣的话
可以去仔细看一
下啊我们先休息一下
好
我们继续
好
现在基本上可以看到这个图片了
嗯
然后关于这个test的使用
blue啥我们也可以推荐大家看一下呃
8号无双老师的这个专栏啊
他还是比较活跃的
然后呃
鲍老师最近
应该已经入职
华东师大心理系心理学院了
OK那我们刚才讲的是test
它是一个一个
我们就是在数据分析当中
常会碰到一种情境
对吧不同的主
他的某一在某一个变量上
君子是不是一样的
以这种情景讲解了一下
如何在r里面升t
test
然后呢以及他跟这个
这个线型模型之间的一个关系
是什么样的
对吧
我们可以看到他基本上对于所有TikTok
然后
我们都可以从采用这个线型模型
来进行实现
这个代码呢
也可能也不止一种写法
对吧而且有不止一个r
呃这个r的包来提供这个函数
所以我们已经能够看到这种灵活性了
对吧呃
对于数学者来说
有的时候
这种灵活性
可能是就是比较令人害怕的
因为你不知道选哪个
不知道选哪个是对的
对吧那么我们在这个方法分析中
我们更能够看到这种情况啊
方法分析
基本上也是我们心理学常用的
一种非常常见的一个统计方法
对吧
我们基本上在学新统计的时候
有很大一部分的这个内容呢
就是学呃
如何进行方差分解
心理学同学都应该有这个体验吧
就是你手中的如何去分解这个方差
对吧
那假如说
我们在以这个判给这个数据的一个呃
一个数据呃
一个假想的一个问题为例吧
就是说
对于我们刚才看的这个恋爱状态
对吧
它好像对个体的体温没有太大的影响
那我们进一步想看
它是不是跟这个呃与刺刀的呃
这个距离会有一个交互作用
那因为大家知道
就当我们隔赤道的越远的话
就说明我们所处的这个气温带
是越越寒冷的
对吧有没有一种可能
大家可能自己在做探索
做数据分析的时候也可能去探索对吧
或者去思考
比方说我们发现某一个自变量
它没有影响
那么会不会
它是受到了另外一个自变量的调节
对吧比方说
在另外一个自变量的不同的水平之下
那么我们的
我们刚才检验过的这个变量对吧
他的在音面上取值是可能有大有小的
最后合并起来呢
就最后导致好像没有效应了对吧
他有可能是跟另外一个自变量
有交互作用
那么这个时候我们可能需要去检
去探索一下呃
去检验一下我们这个假想对吧
比方说在我们这个数据当中
呃有没有可能恋爱状
它实际上是影响体温的
但是
他可能只在一些比较寒冷的地方
起作用对吧
在比较暖和的地方呢
他体温已经达到了
一个不需要被调节的
一个一个一个
相当于是我们说的这个实验
项羽这种天花板了
对吧他已经不需要被调节了
所以呢也没有办法进行调节
那我们可不可以
我们可以
就是说检
验一下对吧
是不是说他与赤道的这个距离之间
有一个交互作用
那么要检验这个交互作用的话
我们一般就会想到这个
双因素的方式分析对吧
双因素的这个
一般来说
我们讲这个呃方程分析的时候
我们讲完全随机的方程分析对吧
但是这里我们需要注意啊
我们用的是这个双因数的
倍时间的方程分析
但是他肯定不是完全随机的OK
呃也就是说
处于这个赤道不同
就是跟赤道保有不同距离的这些人
对吧以及属于不同状态的这些人
他都不是我们随机分配的
不是说哎
我把你分配到
离赤道比较近的一个恋爱状态这个组
对吧我们是不可能做到这一点的
因为这是一个横断数据
但是呢
我们可以用它来去做这个数据分析
那么方案分析的话
那么大家在学统计的时候
可能会呃提到一些对吧
它包括它的历史呃
以及它检验的这些假设是什么
那么对于我们来说
这个它所检验的假设是比较关键对吧
就是在各因素各个水平
在这个水平各水平下面对吧
那么这个音面上的均值
完全是呃相同的
然后呢我们这个贝格假设
就是各因素各水平下面
那么音面上的均值不完全相同对吧
那么通常只要是
只要是有一个不同的可能
这个呃
放大会议就能够把它探测出来对吧
当然它也会有一些使用的前提假设
或者前提预设对吧
包括这个呃
随机性啊
正态啊还有独立啊等等
放大气性
等等这些我们就不在这里复述了
我们关键是说
它在答案里面如何实现
那么如果说大家去问大语言模型对吧
我们如何进行这个呃
多因数的方套分析
那么他会给出一个
我们接下来最常使用的一个函数
那么在这个做呃在哪里面
做数据分析之前
我们肯定还是跟之前一样
要做一些预处理对吧
比方说我们可以看一下
我们刚才说的是DEQ对吧
就是隔4道之间的距离
那么我们可以看到隔4道之间距离
它可能是一个
它是一个数值对吧
那么最小的话
它可能比方说是一一点多
这个比方说我们是用的这个度数对吧
北纬多少度多少度
然后我们发现呢
它是一个连续的数据对吧
但是我们刚刚说的
我们可能想把它做方特分析
那么这个时候呢
我们可以人为的把它分成
比方说三个水平
我们可以分成热带温带和寒温带对吧
那就是我们适合我们人类居住的
那我们根据比方说这个纬度的区别
我们自己设定一个分隔点比方说
赤道到呃一次偏离23.5的对吧
我们就是认为这个地方是热带
呃 35的就是热带
然后35到40的我们是温带对吧
呃
这个地方35到40是叫做暖温带
然后40到50是中温带
我们把它都称为温带对吧
然后还有50以上就是寒温带
那么我们实际上就是通过这个设定的
几个叫做
像是把这个数据分成几个不同的部分
对吧就是0
然后到35中间的就是热带
然后35 到50之间就是温带
然后66.550到66.5之间呢
就是这个寒温带
我们可以用它里面的一个函数叫做cut
对吧
就是将这个数据DQ这个连续性的数据
剪成不同的这个不同的段
然后呢给它分了不同的值
那么给
并且给它取了一个新的名字叫做呃
叫做这个climate
大家可以想象我们是不是
我们能不能用Mute来创建这个
大家也可以试一下
那么我们也可以在哪里面
很轻松地实现
就是在做方差分析之前的
一系列的这个统计预测的一些检验
对吧包括这个正在性的检验
啊这里面包括有两个
一个是KS检验对吧
还有这个QQ图啊
这个是大家可能如果用r
用r的话很容易绘制出这样的图对吧
去检验正态性的
还有他的这个直方图
我们之前也讲过
我们去看一下他的这个呃
数据的一个分布对吧
啊这是贝氏的均值的一个分布
那么我们可以看出它是一个呃
是一个连续的数据对吧
可能不是完全正态分布
但是比较接近正态分布的一个值
然后我们如何去
前面讲的都是数据运输理对吧
那么我们如何实行防潮分析
那大家如果问大于模型
基本上就会得到这个函数对吧
就是用LV
这个也是r里面自带的
或者说当你安装r以后
它自己会有一些包
其中一个包就是States
我们的t test呢
其实是用了它
然后那个l m的函数也是它
那么做方程分析的时候
大家首先会碰到的也是也是这个
也是这个包
那么他写的这个
呃这个
这个就写这个方程
或者说做他的
这个语法跟teach是很像的
还是用的这个线性回归的这个写法
对吧我们把音变量写在前面
然后把自变量写在后面
然后中间呢
用一个长号
那么然后数据呢
是我们刚才选择的这些数据对吧
那这里会有一个通用的一个语法啊
就是就是一个长号
那么这个长号呢
表示就是呃
它们的主效应及其交互作用
那么这里他等同的就是呃
他等同的就是climate
然后加上嗯
romantic对吧
就是这表示他们两个的主线语对吧
然后再加上他们之间的交互作用
我觉得用CR表出来就是c
然后冒号啊
大家如果说用r的
后面做分析的话
经常会看到类似的这种写法对吧
然后前面是一个某一个特定的字面
应变量这个波浪号
波浪号的话
表就是一个公式的一个写法对吧
就表示它是呃
以他什么什么做一个什么分布对吧
但实际上就是我们的
这里的呃
类似于我们回归方程里面的等号
但他实际上不是等号啊
这个只是内饰
然后一般来说呢
这个乘号对吧
就是一个新号乘法的它
它实际上在r里面
是做乘法的一个意思
呃这个乘号呢
就是代表
就是两个主相应加一个交互作用
那
那就意味着实际上是
我们如果通过这种方式来写的话
就意味着我们实际上
这个
这个线性方程式有多种写法的对吧
也就说我们可以比方说只写一个对吧
比方说我们t type
是不是就实际上就只写了一个
只写了这个romantic对吧
我们就是temperature
然后romantics
然后在方程分析的时候
我们加了一个climate的主效
也和climate和它的一个交互作用
对不对
那这个是在案里面做线形回归的时候
线形模型最常见的这个呃
方程的一个写法
我们在这里简单的说一下
那么最初或者说在哪里面
最基础这个包里面
当我们做方特分析的时候
他还是他
实际上就是沿用的呃
这个这个呃线性模型的这种语法
然后呢把它变成了我们能够看到的
这个方大分析的一些统计值
对吧比方说这里的f值
还有这个呃p值对吧
还有我们熟悉的这个叫做SS对吧
summer summer square
如果我们做了这个统计之后
然后用summer来查看一下的话
我们看到
它就出现了
我们熟悉的这个方照分析表对吧
就我们刚才说的
然后这里面会有第二个值
然后呢有两个主效益
这climate有romantic
还有他们的交互作用
还有这个残差
OK
那我们现在是可以在案里面看一看啊
刚才没有及时的扑下来
所以是演示失败了
现在我们可以啊
那我们可能需要从头开始运行一下
主要是运行这个读取数据和
note这个package的部分
关于test部分我们就
暂时就不讲了
就就不运行了
然后我们直接来到
方程分析
我们需
首先需要就是生成一个新的变量
对吧叫climate
然后呢再对他进行一个数据的选择
选出我们感兴趣的这个部分
然后做后面的这个分析啊
这些检验呢
大家可以自己再去看看啊
就是解释呃他的一个意义
这个这个应该是统计课上内容啊
因为就是他
涉及到是这些呃
函数背后的一些知识性的东西
那这是我们刚才讲的这个结果对吧
那它对应的
就是我们的这个防灾分析的结果
那这个时候大家可能会发现
有有的同学
至少我经常碰到
在r里面做了一遍分析之后对吧
不放心
然后我要去找一下SPS跑一遍对吧
是不是一模一样的
然后一看还真不一样对吧
然后是climate对50.83对吧
然后这个是1.01
我们看一对对比一下
这个地方是49.39对吧
一点呃一点呃2.8
然后这个是大家很慌对吧
然后就说我到底能不能用这个呢
是不是哪里出了问题对吧
然后这个时候大家第一选择就是
这个r不靠谱
是不是这个r可能他做的不对是吧
或者说我不敢相信他的这个结果
这是很常见的呀
包括我们很多其他的呃这个统计方法
大家在r里面做了一遍之后
可能还会去在SPS里验证一下对吧
那这就有一种可能性
就是说你选择这个方法
或者你通过搜索软搜索引擎
或者大于原模型得到的这个方法
它它跟SPS里面它的在某
些方面的设置可能是不一样的
那么这可能就是导致你同样的数据
看起来使用了相同的方法之后
得到不同结果的
一个很重要的一个原因
那么我们这里面涉及到一个问题
就是为什么这个方向分析对吧
是一个看起来呢
非常呃简单的一个方法对吧
之所以简单
就是我们在本科阶段就学过他对吧
而且很熟悉
但是他为什么会不一样呢
这里面可能会涉及到一个
我们在至少在国内啊
很少有统计课上会讲到的一个点
就是说呃不同的平方
平方和的这个计算的方法
那么当我们所谓是在平衡设计之下
那么这三类平方和的这个结果呢
是没有差别的
但是
当我们的这个结果不平衡的时候呢
这个时候我们会有一些调整
呃至于具体的原理是什么
我们在这里就不不展开了
但是大可以告诉大家这个知识点
就是说在我们做方向分析的时候
当你的数据在不同组织间
是不平衡的时候
那么你有三种方式
去计算它的这个f值
可以这么理解
我们称之为三类SS
那么我们这里就简单的说了一下
这个三类对吧
什么叫不平衡呢
就是大家可以看到
我们这里有两个变量对吧
一个是climate它有三个值
然后另外一个是我们给他有两个
他有两个曲子对吧
那么他进行组合之后的话就是有六种
六个曲子对吧
就六个条件
这六个条件下面的背时量
他可能是不一样的
那么通常我们所谓均衡的设计
或者平衡的就是它六个cell
6个就是两个这边的
它组合之后的这个呃条件啊
每个条件下的背时量
理论上最好是一模一样的
这个会比较好
当它不一样的时候呢
就会引起我们这个计算方差的时候
的一个区别
大家还记得我们
我们在做SPS的时候
是有一个方差对吧
那么方差我们会那个分母呢
我们一般会有有一个n减去一对吧
就像方差的时候
那么你像分组不一样的时候
你你那个n减去一
它就会有不一样对吧
所以当你不同组的时候
我们可能要把不同组的这个方差
进行合并
那么这个时候呢
我们就需要进行调整
那调整的时候有不同的方式
那么所以我们就有三类的这个方差
那么SPS里面默认的是三类方差呃
然后呢在其他的软件里面呢
比方说这个space OV里面
它默认的是一类方差
所以这个时候我们现在的这个
他是一个很不
很明显不均衡的一个设计
对吧因为我们没有
我们其实就是根据呃
这个气温带和呃
是不是不是处于这个亲密关系中
进行的一个分组
所以很明显他可能是
或者说
他出现均衡设计的可能性很小的
那么在这种情况之下的话
三类方式的这个f值呢
就是不一样的
就大家大家可以记住这个知识点后面
呃去查一下啊
那么这里一个核心的一个点就是
当大家碰到这种不一样的时候呢
有的时候不一
定是我们的r出了问题
或是r是错的
只是大家默认的这个设定是不一样的
那么这就意味着
我们需要去更加清楚的去理解
这个知识点
明白吗
这实际上就是我们在寻r的时候
我们就是帮助大家
去不断的去强化统计知识的
一个呃
一个点吧
就是他会比SPS要求更高
为什么呢
因为SPS我们就是点完了之后
他很绝大部分时候呢
呃他没有太多的这个选项在里面的话
你就会有很多不同的选项
然后不同选项他的设定
默认设定肯定是不一样的
最后你你要搞清楚这个区别呢
你必须要去了解
背后的一些原理和知识
那么
我们能不能得到一模一样的结果呢
实际上是可以的对吧
比方说我们可以用这个呃FX这个包
呃FX是大概是20
我不知道是
应该是1718年以后出现的一个包吧
呃那么FX呢
它就是为了去呃
适合实验心理学家
做方法分析的一个包
那么
这里面有各种各样方法分析的功能
那么
如果我们用FX这么一个写法的话呢
就是把贝式的这个identity写在这里
然后呢
它就会然后把这个type设为3对吧
然后它会得到一模一样的一个结
一个结果
那么我们也可以用blue啥里面的这个
同样可以得到一模一样的结果
也就是说我们你用最常见的这个
呃r的这个代码对吧
他极有可能会得到
跟SPS是不一样的结果
那么同样的这
个现象呢
还会发生在
比方说大家习惯用a MOS做做
比方说这个做这个SEM对吧
结构放射模型
那么你用r的一些呃包
去做这个结构放射模型的时候
同样的数据
同样的结构
它可能会得到不一样的结果
那也有可能是因为它内
内部的设定是不一样的
你要去了解它的内部的设定是什么
那么我们刚刚说呃
这个low前面讲的是这个
这个test对吧
它是一种特定的啊
一个呃一个回归模型
那么nova的话
我们从这个他的写法上讲对吧
我们就很明显看出
他就是一个回归模型
因为他的这个方程的写法
就是类似线形模型那个写法
对吧就是有几个字面啊
他们之间有没有交互作用
所以呢在呃我们常用的这个
比方说单因数的方道分析
和多因数的方道分析
对吧那么在我们这种情况下
两因数的这个方道分析
它都是一个特殊的一个回归模型
那么它特殊之处呢
就在于我们的自变量
它是一个分类变量
或叫做离散变量对吧
那么假如说我们这里有一个呃22的话
22的这个就是相当于有4个条件的话
那么这四个条件
大家可以看到就有点类似4组对吧
那么你的呃四组倍式
那么在某一个音变量上
他他们都会有自己的呃取值对吧
那么这四组倍式的这个均值
是不是完全一模一样的
对吧
那么他们有没有偏离总体的这个均值
这就是我们呃做方差分析
的一个核心要检验的一个东西
对吧
那么在线性模型上面
它也是检验成同样的一个东西
我们可以看到
比方说我们把它通过这种呃
某种方式对吧
对自变量进行编码了之后
那么这个时候我们看到就是
比方说各组的君子对吧
他和其他组之间的区
这个君子的区别
到底有没有达到显著的水平
比方说
我们这里通过一种非常简单的一个
这里展示的
是一个非常简单的编码方式
也就是我们以某一
某一种条件下的一个执着为零点
对吧
就是比方第一组
然后其他的所有的都是
就是其他的
这个所有的系数啊
都是呃
都是就组间的一个差异
都是把其他的组的君子
和那个作为起点的
作为我们旋律的这个君子进行比较
这么讲起来可能有点抽象啊
再想想就是
嗯
比方说
我们就是22对吧
假如说我们会举个什么例子
就是Romantic这个对吧
那么我们刚才讲这个romantic时
我们可以把它变化为0和一
对不对
那么同样的
比方说对climate
我们是不是也可以把它变化成为0
和一对吧
假如说他这两种情况
我们简化方便理解啊
那么
这里面是不是有一个组合
就是0和0对吧
你把灵魂灵带到这个那个里面
他是不是就变成了我们这个回购方式
这个背揽灵这个部分对吧
也是我们贝塔林
在这种编码的方式之下
贝塔林它代表的
就是一个条件之下的一个君子
对吧
那么我们可
以通过这种方式的话
就就可以看到比方说杯的一
他可能代表的是
比方说他取之为一的时候
他取之为一的时候
这种条件下的一个一个值对吧
或者是杯的杯的2的话
就是可能是他为一
他为2的
他为0的情况
还有就他们两个都唯一的一个情况
对吧
那么所有的这个这些回归系数的话
就都可以变成了
一个组件的一个差异值
然后我们的这个logo的话
呃不不我们这个回归模型的话
就是去检验
这里的差异到底是不是显著的
对吧当我们在做回归模型的时候
可能我们检验的这个显著性
是稍微有点区别的
那在这种最简化情况下
大家可以看到
就是我们的这种22的一个呃
两因数的方程分析对吧
它就完全可以对应成为一个
移善变量的一个回归模型
那么我们这里也可以看到呃
如果我们采用这个LOFA对吧
或者是我们采用线性模型
如果我们的设定是一样的话
我们都用LV这个形式的话
他们得到结果是完全一模一样的
这里是不是可能讲的有点
有点快还是什么
大家可能后面要去回顾一下
自己学的那个献血回归的知识啊
因为呃
这里稍微
因为我不知道
其他的统计老师在讲线性回馈的时候
有没有去把它和Lova啊
t test进行关联啊
嗯它本质上大家可以这么理解
本质上都是一个东西
但是
假如说大家说OK
我我现在大概知道了呃Lova
它就是现已回归了一个特定的模式
对吧但是我在自己做研究中
我还是要去报告
这个传统的方特分析的结果
那么这个时候
我们仍然推荐大家用Prosa
呃不是3呢
它有一个很强的一个函数啊
就是Malova呃
就是在nova前面加了一个m对吧
它它这个表示的就是
基本上所有的这个nova
我们心理学常用的
它都可以实现
所以它是一个非常呃
大大的简化了我们心理学的人使用呃
这个方法的一些
呃
就使用这个方法的一个门槛吧
那么这里有主要参数的话
呃
我们就不细讲
大家可以去看一下
然后呢呃非常的全啊
而且呢他有个非常好的特点
就是说
他可以直接给你保存为一个三线格
保存三线格了之后呢
呃我们就可以直接粘贴
到自己的这个word文档里面
去报告结果了
那比方说我们刚才实现的
我们刚才的这个讲解的这个内容对吧
要对呃
climate和romantic做一个呃放大分析
那么我们调用的就是这个Melova的函数
然后DV就是dependent variable等于temperature
然后这个它的这个参数啊
也非常符合我们心理学员的一个习惯
就是采用的是between
表示的是组件的一个变量
所以我们这里有两个组件的变量
然后大家可以看到这个地方
得到的结果就是跟SPS是一模一样的
呃然后是50.88
然后这个是一点
那么它跟SPS不一样的时候
它的的的地方在什么呢
就是它会
输出这个intersquad呃
输出这个generalized intersquad呃
是这个这个房价分析的一个效应量
效应量的指标
那么对于
对于我们传统
就是说在讲传统心理学的时候呢
我们一般只是关注这个p值对吧
但实际上最经济的那个趋势呢
就是
大家会越来越关注这个效应量有多大
不仅仅是你这个p值是不是显著
而且是你这个效应量是不是足够的大
然后在步伐里面呢
我们他还有一个呃
就是imings
就是做进一步的这个简单效应分析
和事后的多重比较
那么这个实际上呢
也是我们在做方案分析的时候
常常会做的对吧
呃
这里话
大家后面就这个地方是比较灵活的呀
也就是说呃
比方说
你用的是纯粹的背时间的设计的话
那么这个时候你可能就是要比较
呃就没有这个简
就是说你可能比较应该是没有交
没有交互作用的时候对吧
我们可能就是做适适合多种比较
也就说某一个条件之下
他的不同水平之间有没有差异对吧
但是如果是有交互作用的话
我们这个时候可能就需要去啊
重新的去看
他的
这个在某一个质变量的水平之下
另外一个质变量有没有效应
对吧这个时候我们称之为简单效应
那比方说我们可以看啊这个
在climate下面
然后
在在在这个romantic下面
这个climate有没有效应
对吧也就是说我们根据啊
不同的romantic这个条件
不管是单身的还是不单身的
对吧然
后再看这个climate它到底有没有效应
啊这个地方好像结果不是特别好
我们可以直接打开这个
打开阿赖看一下
首先我们可以呃
简单看一下在bull啥里面它的输出
我们刚才说
它的输出
是比较符合我们心理学的人的习惯的
呃
大家现在这里看到就是我们用多少
然后用logo这个函数对吧
然后直接做这个放大分析
那么它的输出的话呢
呃就首先输出的是这个描述
描述性的这个统计
然后climate它有两个
有热带对吧
有温带有寒寒温带
嗯
然后这个romantic
呃这个romantic呢
它就是分成了恋爱和单词两个方向
对吧然后它们的均值是多少
SD是多少
然后n是多少
呃这里我们很明显看到
这个n是不不一样的
对吧呃从158到331之间是就是在变化的
然后呢
他会给出一个这个方差分析表对吧
那么在这个地方
他会给出比方说呃
climate的一个主效应
我们
这跟我们的这个预期是完全符合的
对吧就是说在不同的呃气候带的话
人们的体温是有区别的
那么有很强的一个就p值是非常小的
对吧f值也比较大
而且这个f值跟SPS是一样的
因为我们用的是这个第三类的SPS
对吧跟呃SPS保持一致
然后我们看
他的这个交互作用也是显著
对吧
某种程度上就是跟我们的预期是
跟我们的猜想是有是一致的
也就是说我们第一次用test的
我们说
看一下处于这个不同的关系当中的人
他们体温是否有区别
我们发现没有区别
然后呢我们怀疑他是说
嗯
因为人的体温也受到climate的影响
对吧
受到你所处的温带气温带的影响
所以呢我们就觉得
这个romantic的影响可能比较微弱
那么它可能就是被其他的因素给
呃就是掩盖了
看不到那
我们把这个气候带的因素引进来之后
我们看一下
就是这个romantic跟他有没有
有没有有没有交互作用
对吧这个其实就是我们最关心的
我们发现他可能是显著的
那么在Brothers里面还有个好句
是把这些都给你输出来
对吧比方说这里有it square
呃呃
这个这个
这个叫做Pash it square
然后这个就是generalized的it square
一般来说的话
如果要做原分析的话
呃大家可能会报告这个比较多呃
实际上关于这个方差分析的效应啊
也是一个也是一个很重要的知识点了
而且这个知识点也没有那么容易
呃
当然大家可能比方说
很多时候我们都没有去没
如果不做缘分的话
也不需要关心
他的这个效应量之间的转换是怎么样
对吧但是呢
呃不是啥
还是很贴心的
就是把这个不同的效应量之间的
这个转换
呃写出来了哎
包括cos f对吧
cos f实际上是在呃
我们讲项羽量的时候非常常见的一个
呃一个一个指标
然后还有检
检验这个方差的同质性
对吧然后他
的结果
就是这个方差其实是不同质的对吧
那么这个时候应该怎么办
可能我们要进行一些校正对吧
等等等等
所以呃
这个不是啥呢
它的一个好处
如果说我们纯粹的做方案分析的话
其实它是非常的呃
就是非常的
符合我们心理学员的使用习惯的
然后我们刚刚说
呃
假如说我们发现了这个交互作用对吧
一般来说
发现交互作用之后
我们可能要进一步的看
这个交互作用代表了什么
对不对所以我们还希望知道呃
进一步的这个结果对吧
所以这个inims呢也是呃
很方便啊
就是帮助我们去查看呃
不同的这个条件之下的这个结果
怎么样
比方说我们这个地方猪啥的
第一个代码对吧
it means然后climate by Romantics
就是我们会在romantics不同的条件下
去看climate到底有没有效应
这就是我们说的这个简单的主效应
对吧或者叫简单效应
然后
它会很
也会跟我们输出之前的一样的一个呃
这个这个三线表
那么在这个三线表里面的话
大家可以看到在恋爱的情况下面
climate有效应对吧
那么在呃单身的情况下
climate它也有效应
它的这个效应呢
可能会呃
效应量上面可能会有一点点区别
然后同样的话
他会输出就是说呃
这个在不同的条件之下的一个均值
那么这个时候这个地方呃
我们之前都已经看到过了
另外一个就是在恋爱状态之下
还有一个就是说他会给出非常精
确的这个这个
这个叫做paradise test对吧
就是把你每一个条件都进行一个比较
然后我们这里看到的是什么
就是在恋爱状态下的
各种各样的contrast
对吧
温带热带寒温带热带寒温带和温带
这实际上就是说我们看到了这个地方
climate在两种不同的恋爱状态之下
都是险追
对吧然后我们进一步做事后的比较
然后我们就在恋爱状态下看三种条件
三种契合带两卵比较对吧
然后单身状况之下
这个契合带的两卵比较
进一步的查看这个结果到底出现在哪
对吧但是我们发现
基本上所有的都是都显著的
然后呢我们刚才是以恋爱状态
作为一个分组条件
对吧我们在不同的恋爱的这个
这个群体里面
看气候的效益
对吧
有时候相对是我们是分别去
比方说
当我们看恋爱状态这个这些人的时候
就是把单身的状态就
我们就完全不管他了
对吧
我们就只看在恋爱状态这批人里面
气候对体温有没有影响
然后我们看它OK
是有影响的
为什么呢
因为
然后我们可以回到这个emis这个结果
对吧
在恋爱状态下面
climate它是有影响的
f值是13.165对吧
然后p值是0.05
那么这个时候
就相当于是
我们做了一个单因数的方差分析啊
对吧我们发现这个单因数climate
它是显著的
一般来说
我们就进一步的去看它的这个climate
这个因素里面
各个条件之间是不是差异显著
对吧这就
是我们说的叫叫做post HOC的
这个comparison
叫事后的一个比较对吧
所以呢才会有了这个表
就是在恋爱的状况下
比方说
我们比较三种不同气候的一个差
差异值
然后这个是我们只看恋爱的对吧
这群人
气候不同气候组的这个数据的差异
那么同样我们也可以看单身这个
这个数据里面
气候的一个不同气候条件下的
他们一个差异
对吧
但其实我们更关心的可能是
说到底这个恋爱关系有没有影响
对吧
大家还记得我们第一次做test的时候
我们讲看恋爱关系有没有影响
然后呢
那么我们就可以以这个气候带
作为分组条件
对吧我们就先看热带的
在热带的这组里面
哎这个恋爱关系有没有影响
看温带的
看这个气候关系有没有影响对吧
看寒带的
然后这个亲密关系有没有影响
所以是这么一个分组
那么因为这个亲密关系
它只有两个指数对吧
所以我们只需要分一次就完了
就比方说
我们按照climate分成三个组之后
每个组里面
它实际上就是两个条形的一个比较
对吧
然后这个时候我们可以看到
跟我们的预期是比较一致的
就是在热带和温带
这个恋爱关系都没有什么影
都没有显著的影响对吧
但在比较冷的这个气候条件下
就是恒温带对吧
这个时候romantic它是有影响的
也就是说
我们这个这里其实就说明亲密关系
它对于人的温度
可能它确实有调节作用对吧
但是
是在比较冷的情况下会调节
你在温带在热带都不需要调节了
也就是
呃这个总体来说的话
还是还是一个挺有挺有趣的一个现象
那么同样它会在这个
呃
大家可以看到这里的话
他是做了一个f检验对吧
他首先就是看用的是
比方说在热带
温带和寒带三种条件之下
去做方差分析
单因数方差分析
对吧但这个时候单因数方差分析
它其其实只有两个水平
所以呢
它跟这个后面的这个叫做powerwise对吧
这种一对一的这个比较
是基本上结果是完全一模一样的呀
啊大家可以有兴趣的话
可以看一下这个
这里的t值
和这里的f之间的关系是什么
OK
我们其实在这里的话
呃把这个inming
这里的拆分的比较讲得很清楚啊
因为这实际上是我们心理学会常用的
那么我们简单的回顾一下
呃回顾一下
就是说在我们这节课里面
讲到了
单因数方程分析和多因数方程分析
啊我们主要讲多因数方程分析
但是单因数方程分析法其实是一样的
这里多了一个t
然后呢自带的函数都可以用LV对吧
但是我们发现
自带的函数可能跟SPS不太一样
呃所以呢
呃
我们可以采用其他的包的这个函数
同样的
对于自带的这个函数的AOV的话
它有一个等同的一个线性模型的一个
啊写法这两个完全是一模一样的
那么从这个角度讲的话呢
就是说呃
单一式的方式
分析对吧
就是有一个离散制变量的
一个回归模型
因变量是这个这个呃
连续的变量对吧
那么多一式的方式分析它
就是有多个离散制变量的
一个回归模型
那么这里顺便就是再提一点
提一点就是说当我刚刚学习阿的时候
2016年的时候
实际上能够用的除了LV以外
并不是很多
但是r的这个生态
我之所以说为什么要推荐大家用r
原就是因为在过去几年里面
实际上有很多包被开发出来了
包括我们看到PROS r
包括我们看到FX
它很适合心理学的人使用
就是因为在过去几年
大家把这些包都开发出来之后
现在我们心理学的人
再去用这个包的时候
完全没有任何的负担
因为它可以输出
跟SPS一模一样的结果
对吧这样让导师让同学都很放心
然后我们这节课呢
讲了两个知识点啊
可能在讲这个线性模型的时候呢
呃
有有同学可能听得不是太懂
因为可能回归模型
大家也也有点不太熟悉
所以
把回归模型和t test进行连接的时候呢
可能这个地方大家可能要再看一看
再去想一想
翻一翻本科的这个教材
呃把这个关系理清楚
呃很重要点
就是说我们学代码只是应用
但是你要用正确的话
还得你要去有这个背后统计知识
你要懂对吧
那么我们今天这节课的内容呢
就是在这个表上面
基本上就可以总结了
呃这个表格呢
我们是参考了另外一个呃
国外的一个博客
上面的就是我们常见的这些
呃
常见的这些统计检验都是方丈分析
呃不都是线性模型
大家后面也可以自己去看一看
这个博客
那么最后呢
我们留一个思考题
就是说我们讲的都是这个贝时
贝时间的一个设计
对吧那么对贝时内的设计来说
我们如何用回归模型来做这个
大家可以想一想
然后呢如果大家想要强化一下
我们这节课内容的话呢
有一些课堂的小练习
呃大家可以看一下
自己能不能去写出这个代码来
呃去做同样的一个检验
包括用多种方式来实现
行呃
我们这节课就到这
抱歉
刚开始的时候有一点不太顺利啊
因为这个电脑的同步的原因
好谢谢大家



# 以下是代码部分

 


## 纯粹的R代码学习 → 使用R语言来实现统计知识 

## (1) R: 更灵活的统计分析方法，与统计知识结合更加紧密

## (2) 心理学/社会科学中常用的统计检验均是回归模型


研究问题


## 在penguin数据中，恋爱状态(romantic)对被试核心体温(Temperature)的影响


## 在penguin数据中，距赤道距离(DEQ)和恋爱状态(romantic)对于被试核心体温(Temperature)的影响





Contents

8.1 t-test & linear regression</span></center> 
8.1.1 独立样本t检验</span></center> 
8.1.2 线性回归</span></center> 
8.1.3 单样本t检验</span></center> 
8.1.4 配对样本t检验</span></center> 
8.1.5 bruceR::TTEST</span></center> 

8.2 ANOVA & linear regression</span></center> 
8.2.1 研究问题</span></center> 
8.2.2 代码实操</span></center> 
8.2.3 线性回归</span></center> 
8.2.4 知识延申</span></center> 




8.1 t-test & linear regression



8.1  研究问题

```{r, echo = FALSE, fig.width = 3, fig.height = 2}
knitr::include_graphics('pic_new/chp8/IJzerman2018fig.png')
```
(引自[IJzerman et al., 2018](https://doi.org/10.1525/collabra.165))


Q: 如何检查恋爱状态(romantic)对核心体温(Temperature)的影响？

A:独立样本t检验


# 8.1 t-test
## 8.1.1 独立样本t检验(independent t-test)


[基础知识]


比较两个独立样本群体的均值是否有显著差异。

前提条件
 正态性：两个样本数据都应该来自正态分布的总体。样本量足够大时，即使不严格服从正态分布，结果也是稳健的。
 同方差性：两个样本的方差应该是相等的。
 独立性：两个样本应该是独立的，即一个样本的观测值不应影响另一个样本的观测值。


假设
 $H_0$: 两个独立样本群体的均值没有显著差异，即 $μ_1$ = $μ_2$
 $H_1$: 两个独立样本群体的均值有显著差异，即 $μ_1$ ≠ $μ_2$

$$t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$$

[数据清理]

```{r preprocessing}
df.penguin <- bruceR::import(here::here('data', 'penguin', 'penguin_rawdata.csv')) %>%
  dplyr::mutate(subjID = row_number()) %>%
  dplyr::select(subjID,Temperature_t1, Temperature_t2, socialdiversity, 
                Site, DEQ, romantic, ALEX1:ALEX16) %>%                                     # 选择变量
  dplyr::filter(!is.na(Temperature_t1) & !is.na(Temperature_t2) & !is.na(DEQ)) %>%         # 处理缺失值
  dplyr::mutate(romantic = factor(romantic, levels = c(1,2), labels = c("恋爱", "单身")),  # 转化为因子
                Temperature = rowMeans(select(., starts_with("Temperature"))),             # 计算两次核心温度的均值
                ALEX4  = case_when(TRUE ~ 6 - ALEX4),
                ALEX12 = case_when(TRUE ~ 6 - ALEX12),
                ALEX14 = case_when(TRUE ~ 6 - ALEX14),
                ALEX16 = case_when(TRUE ~ 6 - ALEX16),
                ALEX   = rowSums(select(., starts_with("ALEX")))) # 反向计分后计算总分
```

```{r, echo=FALSE}
DT::datatable(head(df.penguin),
              fillContainer = TRUE, options = list(pageLength = 4))
```

[代码实操]

```{r ttest in stats}
stats::t.test(data = df.penguin,      # 数据框
              Temperature ~ romantic, # 因变量~自变量
              var.equal = TRUE) %>%
  capture.output()                    # 将输出变整齐
```



# 8.1 t-test作为回归模型的特例
## 8.1.2 线性回归(linear regression)

回归分析
 回归分析用于研究一个或多个自变量（预测变量）与一个因变量（响应变量）之间的关系。




线性回归
 线性回归的基本思想是通过数据拟合一条直线，使得这条直线尽可能地接近所有的数据点，从而实现对新数据点的预测。
 线性回归模型可以表示为：
$$y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon$$

 其中，$y$是因变量，x是自变量， $\beta_i$  是模型参数，表示截距和斜率，$\epsilon$是误差项，表示模型未能解释的随机误差。


# 8.1 t-test & linear regression
## 8.1.2 线性回归(linear regression)

 独立样本t检验是线性模型的特殊形式(自变量为二分变量）


  <img src="./pic_new/chp8/indet-lm.png" width="55%">




# 8.1 t-test & linear regression


```{r ttest,results='hide'}
# t检验
stats::t.test(
  data = df.penguin,
  Temperature ~ romantic,
  var.equal = TRUE) %>%
  capture.output() # 将输出变整齐
```


  <img src="./pic_new/chp8/compare1.1.png" width="100%">



```{r ttest in lm,results='hide'}
# 线性回归
model.inde <- stats::lm(
  data = df.penguin,
  formula = Temperature ~ 1 + romantic
  )
summary(model.inde)
```


  <img src="./pic_new/chp8/compare1.2.png" width="100%">



# 8.1 t-test系列均为回归模型的特例
## 8.1.3 单样本t检验(one sample t-test)
 例如：在penguin数据中，全体被试的核心体温(Temperature)是否等于36.6？



比较单个样本的平均值(m)与已知的总体平均值(μ)之间是否存在显著差异


前提条件
 正态性：样本数据应来自正态分布的总体。样本量足够大时，即使不严格服从正态分布，结果也是稳健的。
 独立性：样本中的观测值必须是独立的，即一个观测值不应影响另一个观测值。


假设
 $H_0$: 样本的均值(m)与给定的总体均值或假设的总体均值(μ)之间没有显著差异。
 $H_1$: 样本的均值(m)与给定的总体均值或假设的总体均值(μ)之间有显著差异。


$$t = \frac{\bar{X} - \mu}{s / \sqrt{n}}$$


# 8.1 t-test系列均为回归模型的特例
## 8.1.3 单样本t检验(one sample t-test)




$$y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon$$

单样本t检验中，仅截距不为0。此时公式为：

$$y = \beta_0$$
$$H_0: \beta_0 = 0$$


  <img src="./pic_new/chp8/singlet-lm.png" width="75%">


# 8.1 t-test系列均为回归模型的特例
## 8.1.3 单样本t检验(one sample t-test)


```{r,results='hide'}
stats::t.test(
  x = df.penguin$Temperature, # 核心体温均值
  mu = 36.6) 
  
```




  <img src="./pic_new/chp8/compare2.1.png" width="100%">



```{r,results='hide'}
model.single <- lm(
  data = df.penguin,
  formula = Temperature - 36.6 ~ 1
  ) 
summary(model.single) 
```




  <img src="./pic_new/chp8/compare2.2.png" width="100%">

# 8.1 t-test系列均为回归模型的特例
## 8.1.4 配对样本t检验(paired t-test)
 例如，在penguin数据中，被试报告的两次核心温度(Temperature_t1, Temperature_t2)是否有显著差异？


比较两个相关的样本组（例如，同一组受试者在不同条件下的测量）的平均值是否存在显著差异。

前提条件
 正态性：样本数据应来自正态分布的总体。样本量足够大时，即使不严格服从正态分布，结果也是稳健的。
 独立性：配对样本中的观测值必须是独立的，即每一对观测值不应影响其他对的观测值。
 配对设计：数据必须是以配对形式收集的。

假设
 $H_0$: 配对样本的总体平均差与零没有显著差异（两个配对样本的均值没有显著差异）。
 $H_1$: 配对样本的总体平均差与零有显著差异（两个配对样本的均值存在显著差异）。


$$t = \frac{\bar{X} - \mu}{s / \sqrt{n}}$$

# 8.1 t-test系列均为回归模型的特例
## 8.1.4 配对样本t检验(paired t-test)

$$y_1 - y_2 = \beta_0 $$
$$H_0: \beta_0 = 0 $$

可以将配对样本t检验理解为对差值进行的单样本t检验，即单独用一个数字来预测对应的差值（见图的右半部分）。
也可以认为这些组间之差是斜率（见图的左半部分）。


  <img src="./pic_new/chp8/pairt-lm.png" width="70%">



# 8.1 t-test系列均为回归模型的特例
## 8.1.4 配对样本t检验(paired t-test)


```{r,results='hide'}
stats::t.test(
  x = df.penguin$Temperature_t1, 
  y = df.penguin$Temperature_t2, 
  paired = TRUE
  )
```




  <img src="./pic_new/chp8/compare3.1.png" width="100%">



```{r,results='hide'}
model.paired <- lm(
  Temperature_t1 - Temperature_t2 ~ 1,
  data = df.penguin
  )
summary(model.paired)
```




  <img src="./pic_new/chp8/compare3.2.png" width="100%">




# 8.1 t-test
## 8.1.5 bruceR::TTEST
 如果偏好按传统方式使用t检验，推荐`bruceR::TTEST`函数


  <img src="./pic_new/chp8/TTEST.png" width="70%">


中文帮助文档：https://zhuanlan.zhihu.com/p/281150493

# 8.1 t-test
## 8.1.5 bruceR::TTEST

[独立样本t检验]


```{r,results='hide'}
stats::t.test(
  data = df.penguin, 
  Temperature ~ romantic,
  var.equal = TRUE
  ) 
```




  <img src="./pic_new/chp8/compare1.1.png" width="100%">



```{r,results='hide'}
bruceR::TTEST(
  data = df.penguin, # 数据
  y = "Temperature", # 因变量
  x = "romantic"     # 自变量
) 
```



  <img src="./pic_new/chp8/leven.png" width="100%">



[单样本t检验]


```{r, results='hide'}
stats::t.test(
  x = df.penguin$Temperature, 
  mu = 36.6
  )

```




  <img src="./pic_new/chp8/compare2.1.png" width="100%">



```{r,results='hide'}
bruceR::TTEST(
  data = df.penguin, # 数据
  y = "Temperature", # 确定变量
  test.value = 36.6, # 固定值
  test.sided = "=")  # 假设的方向

```



  <img src="./pic_new/chp8/sample.png" width="100%">


[配对样本t检验]



```{r,results='hide'}
stats::t.test(
  x = df.penguin$Temperature_t1, #第1次
  y = df.penguin$Temperature_t2, #第2次
  paired = TRUE) 
  
```




  <img src="./pic_new/chp8/compare3.1.png" width="100%">



```{r, results='hide'}
bruceR::TTEST(
  data = df.penguin, # 数据
  y = c("Temperature_t1",  
        "Temperature_t2"), # 变量为两次核心体温
  paired = T)  # 配对数据，默认是FALSE
```



  <img src="./pic_new/chp8/pair.png" width="100%">



# 8.1 t-test系列均为回归模型的特例



|       | R自带函数 | 线性模型 | 解释 |
|-|-|-|-|
| 单样本t | t.test(y, mu = 0) | lm(y ~ 1)| 仅有截距的回归模型 |
| 独立样本t | t.test($y_1$, $y_2$) | lm(y ~ 1 + $G_2$)| 自变量为二分变量的回归模型 |
| 配对样本t | t.test($y_1$, $y_2$, paired=T)  | lm($y_1$ - $y_2$ ~ 1)| 仅有截距的回归模型)|




8.2  ANOVA & linear regression




8.2.1  研究问题


Q: 如何同时检验距赤道距离(DEQ)和恋爱状态(romantic)对于被试体温的影响

A:双因素被试间方差分析



# 8.2  ANOVA & linear regression
## 8.2.2 代码实操 & 知识回顾


方法简介：

当研究者想要比较两个或多个组之间的均值差异时，可使用方差分析(Analysis of Variance，简称ANOVA)。

它由英国统计学家R.A.Fisher提出，基本思想是将测量数据的总变异（即总方差）按照变异来源分为处理（组间）效应和误差（组内）效应，并作出其数量估计，从而确定实验处理对研究结果影响力的大小。

假设：
 $H_0$: 各因素各个水平下，因变量的均值完全相同
 $H_1$: 各因素各个水平下，因变量的均值不完全相同






前提条件：

 可加性：各效应可加，即观测值是由各主效应，交互作用以及误差通过相加得到的
 随机性：各样本（观测值）是随机样本
 正态性：各样本来自于正态分布的总体
 独立性：各样本观测值互相独立
 方差齐性：各样本来自的总体方差相同
 因变量应为连续变量



# 8.2  ANOVA 
## 8.2.2 代码实操|数据预处理

[vars]

```{r}
summary(df.penguin$DEQ)
```

```{r}
# 设定分割点
# [0-23.5 热带， 23.5-35 亚热带]， [35-40 暖温带， 40-50 中温带]， [50-66.5 寒温带]
breaks <- c(0, 35, 50, 66.5)

# 设定相应的标签
labels <- c('热带', '温带', '寒温带')

# 创建新的变量
df.penguin$climate <- cut(df.penguin$DEQ, 
                          breaks = breaks, 
                          labels = labels)
summary(df.penguin$climate)
```

[tidy data]

```{r}
df <- df.penguin %>% 
  select(subjID, climate, romantic, Temperature) 
  
```

```{r example of df, echo=FALSE}
DT::datatable(head(df), fillContainer = TRUE)
```




# 8.2  ANOVA & linear regression
## 8.2.2 代码实操|正态性检验

[KS检验]

```{r}
# 正态性检验-Kolmogorov-Smirnov检验
# 若p >.05，不能拒绝数据符合正态分布的零假设
ks.test(df$Temperature, 'pnorm')
```

```{r}
# 进行数据转换，转换后仍非正态分布
df$Temperature_log <- log(df$Temperature)
ks.test(df$Temperature_log, 'pnorm')
```

[qq图]
```{r, fig.width=7, fig.height=5}
# 正态性检验-qq图
qqnorm(df$Temperature)
qqline(df$Temperature, col = "red") # 添加理论正态分布线
```

[直方图]
```{r, fig.width=7, fig.height=5}
ggplot(df, aes(Temperature)) +
    geom_histogram(aes(y =..density..), color='black', fill='white', bins=30) +
    geom_density(alpha=.5, fill='red')
```




# 8.2  ANOVA & linear regression
## 8.2.2 代码实操|双因素被试间方差分析

[stats::aov()]

```{r}
aov1 <- stats::aov(Temperature ~ climate  romantic, data = df)
summary(aov1)
```

[SPSS]
```{r, echo = FALSE, fig.width = 4.5, fig.height = 3}
knitr::include_graphics('pic_new/chp8/SPSS.png')
```





结果为什么不相同？



# 8.2  ANOVA & linear regression
## 8.2.2 代码实操|平方和(SS)的计算

在平衡设计中，三种类型的平方和的结果会很清晰，并且方差分析的结果独立于平方和的类型；
而在非平衡设计中，尤其是当各组样本量差距较大时，三种类型的平方和计算结果可能会不同，此时需要根据具体研究设计和问题来选择使用哪一种类型的平方和。

对于 Y ~ A + B + A  B


[Type I SS]

解释变量的顺序会影响到类型I平方和的计算结果，通常用于顺序重要的模型。
效应根据表达式中先出现的效应做调整。A不做调整，B根据A调整，A:B交互项根据A和B调整。

stats::aov()函数默认采用的就是Type I SS，它逐步将每一个因子引入模型进行计算。

[Type II SS]

忽略了因子之间可能存在的交互作用，适用于所有主效应不涉及交互效应的情况。
假定所有的因子都是同时进入模型的，并且它们都是等价的。
效应根据同水平或低水平的效应做调整。A根据B调整，B依据A调整，A:B交互项同时根据A和B调整。

car::Anova()函数默认计算Type II SS，可以通过type = 3调整为Type III SS。

[Type III SS]

更全面，假定所有因子（以及它们的交互项）都是重要的，并考虑所有因素。
每个效应根据模型其他各效应做相应调整。A根据B和A:B做调整，A:B交互项根据A和B调整。

SPSS默认采用Type III SS。
bruceR::MANOVA()函数也默认采用Type III SS，可以通过ss.type = 2调整为Type II SS。

]]]]





# 8.2  ANOVA & linear regression
## 8.2.2 代码实操|双因素被试间方差分析

[car::Anova()]
```{r}
# 结果不一致
aov1 <- stats::anova(stats::aov(Temperature ~ climate  romantic, data = df))
aov1
```

[get results same as SPSS]
```{r}
afex::aov_ez(id = "subjID", 
             dv = "Temperature", 
             data = df, 
             between = c("climate", "romantic"), 
             type = 3)
```

```{r,results='hide'}
# afex中的其他函数可以得到同样的结果
afex::aov_car(Temperature ~ climate  romantic + Error(subjID), data = df, type = 3)
afex::aov_4(Temperature ~ climate  romantic + (1|subjID), data = df)
```




# 8.2  ANOVA & linear regression
## 8.2.3 线性回归






这里的ANOVA仍然是线性回归模型的特例，即自变量是离散变量的情况。

如果使用哑变量（dummy coding）对自变量进行编码后进入回归方程，线性模型中的斜率即是对组间差异的估计。

双因素方差分析可以看作是一种特殊的线性回归模型，自变量为两个分类变量。




```{r, echo = FALSE, fig.width = 3.5, fig.height = 2}
knitr::include_graphics('pic_new/chp8/aovLM.png')
```


# 8.2  ANOVA & linear regression
## 8.2.3 线性回归


```{r,results='hide'}
aov1 <- car::Anova(
  aov(Temperature ~ climate  romantic, 
      data = df), 
  type = 3
  )
aov1
```

![](./pic_new/chp8/compare8231.png)





```{r,results='hide'}
lm1 <- car::Anova(
  lm(Temperature ~ climate  romantic, 
     data = df), 
  type = 3
  )
lm1
```

![](./pic_new/chp8/compare8232.png)




# 8.2  ANOVA & linear regression
## 8.2.2 代码实操: `bruceR`
 使用`bruceR`可以更简单地实现心理学中习惯的ANOVA，但要注意数据格式

  <img src="./pic_new/chp8/ANOVA data.png" width="65%">




# 8.2  ANOVA & linear regression
## 8.2.2 代码实操: `bruceR::MANOVA`

  <img src="./pic_new/chp8/MANOVA.png" width="70%">




# 8.2  ANOVA & linear regression
## 8.2.2 代码实操: `bruceR::MANOVA`
```{r,results='hide'}
res1 <- bruceR::MANOVA(data = df, 
                       dv = "Temperature", 
                       between = c("climate", "romantic"))
```
```{r,echo=FALSE}
res1 %>%
  capture.output()
```



# 8.2  ANOVA & linear regression
## 8.2.2 代码实操: `bruceR::EMMEANS`
更进一步进行简单效应分析与多重比较

  <img src="./pic_new/chp8/EMMEANS.png" width="70%">




# 8.2  ANOVA & linear regression
## 8.2.2 代码实操: `bruceR::EMMEANS`
```{r, results='asis'}
sim_eff <- res1 %>% 
  bruceR::EMMEANS("climate", by = "romantic") %>%
  bruceR::EMMEANS("romantic", by = "climate")
```


# 8.2  ANOVA & linear regression
## 8.2.4 知识延申|单因素方差分析示例
```{r}
# DEQ对Temperature的影响
res2 <- bruceR::MANOVA(
  data = df,
  dv = "Temperature",
  between = "climate") 
```



# 8.2  ANOVA & linear regression
## 8.2.4 知识延申|总结



|       | R自带函数 | 线性模型 | 解释 |
|-|-|-|-|
| 单因素ANOVA | aov(y ~ G) | lm(y ~ 1 + $G_1$ + $G_2$ + ...)| 一个离散自变量的回归模型 |
| 多因素ANOVA | aovt(y ~ G  S) | lm(y ~ $G_1$ + $G_2$ + ... + $S_1$ + $S_2$ + ...)| 多个离散自变量的回归模型 |



课堂总结

![](./pic_new/chp8/route.png)



课堂总结

|       | R自带函数 | 线性模型 | 解释 |
|-|-|-|-|
| 单样本t | t.test(y, mu = 0) | lm(y ~ 1)| 仅有截距的回归模型 |
| 独立样本t | t.test($y_1$, $y_2$) | lm(y ~ 1 + $G_2$)| 自变量为二分变量的回归模型 |
| 配对样本t | t.test($y_1$, $y_2$, paired=T)  | lm($y_1$ - $y_2$ ~ 1)| 仅有截距的回归模型)|
| 单因素ANOVA | aov(y ~ G) | lm(y ~ 1 + $G_1$ + $G_2$ + ...)| 一个离散自变量的回归模型 |
| 多因素ANOVA | aovt(y ~ G  S) | lm(y ~ $G_1$ + $G_2$ + ... + $S_1$ + $S_2$ + ...)| 多个离散自变量的回归模型 |

参考：https://lindeloev.github.io/tests-as-linear/#61_one-way_anova_and_kruskal-wallis




思考
<span style="font-size: 55px;">如何从回归模型的角度理解重复测量方差分析呢？



课堂练习



1. 在Penguin数据中，处在不同恋爱状态下(romantic)的被试在社交复杂度(socialdiversity)上是否有显著差异？


2. 在Penguin数据中，不同气候带(DEQ)与恋爱状态(romantic)对被试社交复杂度(socialdiversity)的影响.


